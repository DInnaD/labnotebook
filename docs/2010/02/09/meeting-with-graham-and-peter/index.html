<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.21" />
  <meta name="author" content="Carl Boettiger">
  

  
  
  
    
    
    <link rel="stylesheet" href="../../../../css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="../../../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../../css/font-awesome.min.css">
  <link rel="stylesheet" href="../../../../css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  
  
    <link rel="stylesheet" href="../../../../css/cboettig.css">
  
  
  <link rel="alternate" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">
  <link rel="feed" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">

  <link rel="icon" type="image/png" href="../../../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../../img/apple-touch-icon.png">
  <link rel="canonical" href="../../../../2010/02/09/meeting-with-graham-and-peter/">


  <title>Meeting with Graham and Peter | Boettiger Group</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../../">Boettiger Group</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="../../../../index.html">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../members/">
            
            <span>Members</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../vita/">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../teaching/">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../lab-notebook">
            
            <span>Lab Notebook</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<div class = "container">


<div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    <h1>Meeting with Graham and Peter</h1> 
      
    

<h3 id="discussion-of-model-comparisons">Discussion of Model Comparisons</h3>

<p>Primary focus of today&rsquo;s discussion was rooted in Sunday&rsquo;s entry</p>

<ul>
<li>On <strong>plotting quirks,</strong> haven&rsquo;t figured out lattice but here&rsquo;s yet
another <a href="http://had.co.nz" title="http://had.co.nz">newer plotting engine for
R</a></li>
<li>I need to revisit how OUCH computes likelihood ratios and P values.
Since some parameters are bounded to the positive real line (and may
be small) the standard chi square isn&rsquo;t correct. I should repeat the
AIC-style analysis for likelihood ratios, though this is just a
shift of where I put the zero line. The correct thing to do would be
to ask what is the probability the observed difference in likelihood
ratio (or AIC, etc) would have occurred by chance using the
distributions I have calculated,</li>
</ul>

<p><img src="http://openwetware.org/images/thumb/4/43/Aic_panels.png/60px-Aic_panels.png" alt="image" />
(click for larger)</p>

<ul>
<li>The approach I am advocating for goes by the name <strong><a href="http://en.wikipedia.org/wiki/Bootstrapping_(statistics)#Parametric_bootstrap &quot;http://en.wikipedia.org/wiki/Bootstrapping_(statistics">Parametric
Bootstrapping</a>#Parametric_bootstrap&rdquo;)</strong>
(that link isn&rsquo;t that helpful actually, could improve the wiki
entry). I should implement this as above, comparing to the observed
differences in the model scores of the real data, rather than the
measure of slightly greater which I report.</li>
<li>Using this approach I can also <strong>evaluate the power</strong> to detect any
OU model by overlap in distributions. For instance, if the tree is
the starburst, even strong selection OU will have no power, while on
another tree it might. This can be done by testing a variety of OU
models, rather than the one that best fits the data, and will be a
great way to start quantifying the <em>information contained in the
tree</em> relative to the model choice question. This is a <em>crucial
step</em> before I try more complicated models, giving some measure of
whether a tree contains enough taxa with enough covariance to tease
out temporal information accurately.</li>
<li>Discussed my concern that the <strong>BM model and OU model aren&rsquo;t really
embedded,</strong> since the OU model likelihood cannot be computed
accurately for small α. Of course it works in the limit, but is
something to be cautious about. It has been suggested that model
comparison should fit OU alone, and wait and see if α comes out
small. There are two reasons to be skeptical of this</li>
</ul>

<ol>
<li>the star burst tree demonstrates that α and σ aren&rsquo;t independent;
then the tip variance is
<img src="http://openwetware.org/images/math/0/8/e/08e417731492414f9f1c6aaf090ad471.png" alt="\\frac{\\sigma\^2}{2\\alpha}(1-e\^{-2\\alpha
t})" /></li>
<li>The likelihood calculation may be numerically inaccurate for small α</li>
</ol>

<h3 id="speed-of-computing-probabilities-for-the-regimes-model">Speed of computing probabilities for the Regimes model</h3>

<ul>
<li>So I can compute the joint probability for an arbitrary model rather
quickly using my discretized matrix approach; if I&rsquo;m given the
transition matrices along each branch. Unfortunately, I spend all
the computational time computing these matrices in the first place.
We discussed several strategies to speed this up.</li>
</ul>

<ol>
<li><strong>Look-up tables.</strong> For instance, rather than calculating
<img src="http://openwetware.org/images/math/d/a/e/daead000f739dd5aa84fd9f58b511b67.png" alt="e\^{-(x\_1-x\_2)\^2/2\\sigma\^2t}" />
I could use the look-up of
<img src="http://openwetware.org/images/math/4/3/7/437ccc3edf32ee596e40ed14de1e3259.png" alt="e\^{-\\beta\^2}" />
There&rsquo;s a variety of places this kind of trick can help with. Also,
judicious use of logs &ndash; never exponentiate when I can multiply, or
multiply when I can add.</li>
<li><strong>MCMC approaches.</strong> The general version of this just does MCMC over
all the internal nodes. The key here is that if I know the values of
all the internal nodes, the joint probability is just a product of
all the transitions &ndash; no non-independence. Alternately, I could
rely on the fact that I can solve this analytically if I were only
told the regimes of the internal nodes, so I just have to MCMC over
the handful of possible regimes at each node, and not the traits as
well. This seems quite promising.</li>
<li>Going from <strong>the generator</strong> &ndash; this could be done for the truly
nonlinear models, as it completely ignores the ability to get
analytic solutions. The generator could be raised to the power of
the branch length. Doing so for the largest branch would allow all
other branches to be calculated in the process. This will probably
be slow but easy to implement.</li>
</ol>

<h3 id="so-what-to-target-next">So what to target next</h3>

<ul>
<li><p>First: the the parametric bootstrap extension and paper.</p>

<ul>
<li>modification of the code I currently have to do likelihood ratio
and compare to the true data.</li>
<li>Also add a function to give scores to trees regarding ability to
distinguish OU and BM models as a measure of the temporal
information they contain.</li>
</ul></li>

<li><p>Lookup tables &ndash; means that giant data structure I wrote for the
regimes model will be useful, (yay and yikes). More memory and
probably more time with valgrind debugging, but could be promising.</p></li>

<li><p>After that I think I&rsquo;ll try MCMC over regimes and possibly the
generator approach. An effective regimes calculation is probably a
ways off yet, but plenty of things to try!</p></li>
</ul>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:http://ogp.me/ns/article#">
  
  
  
<div class="article-metadata">

  <p>
  <span class="article-date">
    <i class="fa fa-calendar"></i>
    
    <time datetime="2010-02-09 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Tue, Feb 9, 2010
    </time>
    
  </span>
  </p>
    

  <p>
  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="../../../../categories/evolution">evolution</a
    >
    
  </span>
  
  
  </p>
  
  <p>
  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="../../../../tags/pmc">pmc</a
    >
    
  </span>
  
  
  </p>

</div>

 
  <br />
  
  <p><a class="btn btn-default" rel="prev" href='../../../../2010/02/09/code-development-for-exploring-regimes-shifts/'><i class="fa fa-chevron-left"></i> prev</a>
    <a class="btn btn-default" rel="next" href='../../../../2010/02/08/exploring-difficulties-with-existing-methods-continued/'>next <i class="fa fa-chevron-right"></i></a></p>

  <br />

  <p> <a class="btn btn-default" 
         href="https://github.com/cboettig/cboettig.github.io/commits/master/content/lab-notebook/2010-02-09-Meeting-with-Graham-and-Peter.md"><i class="fa fa-clock-o"></i> history</a></p>

  <p> <i class="fa fa-barcode"></i> SHA: <a href="https://github.com/cboettig/cboettig.github.io/blob/9d9072923c46d635718a4624d6afff6b1ec2439f/content/lab-notebook/2010-02-09-Meeting-with-Graham-and-Peter.md">9d90729</a></p> 


</aside>

    </div>
  </div>
</div>


<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'cboettig';
    var disqus_identifier = '\/2010\/02\/09\/meeting-with-graham-and-peter\/';
    var disqus_title = 'Meeting with Graham and Peter';
    var disqus_url = '\/2010\/02\/09\/meeting-with-graham-and-peter\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>


</div>

<footer class="site-footer">
  <hr />
  <div class="container">

  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://carlboettiger.info/#me">
      <p>
      <script type="text/javascript" src="../../../../js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
           <a rel="foaf:weblog" type="application/atom+xml" href="../../../../index.xml"  
        class="showtooltip" title="RSS feeds for my blog-style entries." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    


    <div class="col-md-4 col-md-offset-1 col-xs-4">
	    <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="../../../../img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="../../../../img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>
</footer>


    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="../../../../js/jquery-1.12.3.min.js"></script>
    <script src="../../../../js/bootstrap.min.js"></script>
    <script src="../../../../js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="../../../../js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-18401403-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    <script async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML"></script>
    

  </body>
</html>

   