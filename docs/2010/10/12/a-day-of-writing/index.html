<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.20.2" />
  <meta name="author" content="Carl Boettiger">
  

  
  
  
    
    
    <link rel="stylesheet" href="../../../../css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="../../../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../../css/font-awesome.min.css">
  <link rel="stylesheet" href="../../../../css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  
  
    <link rel="stylesheet" href="../../../../css/cboettig.css">
  
  
  <link rel="alternate" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">
  <link rel="feed" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">

  <link rel="icon" type="image/png" href="../../../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../../img/apple-touch-icon.png">
  <link rel="canonical" href="../../../../2010/10/12/a-day-of-writing/">


  <title>a day of writing | Boettiger Group</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../../">Boettiger Group</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="../../../../index.html">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../members/">
            
            <span>Members</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../vita/">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../teaching/">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../lab-notebook">
            
            <span>Lab Notebook</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    <h1>a day of writing</h1> 
      
    

<p>Figuring out the best way to present the critique of AIC, introduction
to the method, introduction to the power test. Seeking inspiration from
Huelsenbeck 1996 and digging farther back into the literature:</p>

<p></p>

<ol>
<li>Cox, D.R. Further results on tests of separate families of
hypotheses. Journal of the Royal Stastical Society 24,
406-424(1962).</li>
<li>Cox, D.R. Tests of Seperate Families of Hypotheses. Proceedings of
the 4th Berkeley Symposium, University of California Press 105 -
123(1961).</li>
<li>Hall, P., Wilson, S. Two guidelines for bootstrap hypothesis
testing. Biometrics 47, 757-762(1991).</li>
</ol>

<h2 id="interesting-question-on-r-sig-phylo">Interesting question on R-sig-phylo</h2>

<p>My reply:</p>

<p>A few responses in-line below, hope they&rsquo;re helpful. In general
averaging over trees to estimate parameters sounds great, a couple
hurdles.</p>

<p>On Tue, Oct 12, 2010 at 5:08 PM, Lara Poplarski
<larapoplarski@gmail.com\> wrote:</p>

<pre><code>   Dear List,

   I am new to R, and hope someone can kindly help with the following
   task. I have a Bayesian sample of trees in nexus format and discrete
   data; example trees and data are at the bottom of the email. I would
   like to use fitDiscrete in geiger to estimate parameter lambda for all
   variables. The idea is to then compare the distributions across trees
   of lambda values for the different variables.

   I have been using the following:

   for(i in 1:5) {
   cat(&quot;t&quot;,i,&quot;\n&quot;);
   fd&lt;-fitDiscrete(treesi,data,treeTransform=&quot;lambda&quot;)
   print(fd)
   }

   A few specific questions:

   1. Since trees in my sample are non-ultrametric, I get the following warning:
   Warning: some tree transformations in GEIGER might not be sensible for
   nonultrametric trees.

   Is the lambda transformation sensible for non-ultrametric trees? I
   could not find further information on this in the manual or in the
   Pagel references.
</code></pre>

<p><br />
 No, the transformation is only meaningful it the trees are ultrametric.
The models describe rates of change through time, and thus assume branch
lengths are proportional to time, not to number of substitutions. This
is true for most models in comparative methods.</p>

<p></p>

<pre><code>   2. In some cases, I get the following warning:
   [1] &quot;Warning: may not have converged to a proper solution.&quot;

   Does it make sense to get fitDiscrete to repeat the ML estimation for
   these cases, until convergence? Can someone suggest how to modify the
   loop above to do this?
</code></pre>

<p><br />
 There are several reasons why the maximum likelihood optimization
routine can fail to converge, and you&rsquo;re quite right that an
insufficient number of iterations is one of them. I don&rsquo;t believe Geiger
supports passing additional arguments to the optim routine. The error
message you see is produced by Geiger and includes both the case when
the iteration number is insufficient or when the algorithm fails to
converge for some other reason (such as a ridge of optima, for instance
a nearly star like phylogeny will always give this error). See the help
page on optim function for more information, but modifying the
iterations and error handling will I believe require you to look into
the geiger code.</p>

<p>In leiu of this, you&rsquo;ll want to note and exclude estimates that do not
achieve convergence.</p>

<p></p>

<pre><code>   3. Finally, I would be grateful for pointers on how to tackle the
   output. For example, can someone suggest how to go about calculating
   the mean lambda value, across trees, for each of the 4 variables?
</code></pre>

<p><br />
 There seems to be a bug in the Geiger code whereby it doesn&rsquo;t actually
report the value of lambda (treeParam) if the data argument is a matrix,
so this requires an extra step (otherwise you&rsquo;d pass the whole data
matrix and could skip my second apply fn).</p>

<p>You want to create a matrix where each row represents a different tree,
and each column a different trait value.</p>

<pre><code class="language-de1">lambda &lt;- sapply(1:n_trees,                        # Apply what follows to all trees
  function( i ){
    sapply(1:n_traits,                                    # Apply what follows for each trait
      function( j ){
        fd &lt;- fitDiscrete(tree[[i]], data[, j ], treeT=&quot;lambda&quot; )     # fitDiscrete for tree i, trait j
        fd[[1]]$treeParam
     })
  }
)
</code></pre>

<p>Then just calculate the average / variance / histogram / etc over the
column.</p>

<p></p>

<pre><code>   I also have a more general question. Both the tree sample and dataset
   are relative large (1000 trees * 80 variables), so based on
   preliminary runs I expect the analysis to take rather long. Any
   suggestions on how to speed things up and/or on a different approach
   to the tree sample/multiple variable set-up would be most welcome!
</code></pre>

<p>Good point. Since the order you do the trees in doesn&rsquo;t matter, an
sapply function can be used instead of a for loop, it is generally much
faster. If you have a multicore machine, take a look at the snowfall
package in R, which will let you run your sapply loop in parallel
automatically. Sounds like it will take a few days to run them all.</p>

<p></p>

<pre><code>   Many thanks in advance,
</code></pre>

<p><br />
 Err, hope that made sense, feel free to ask for clarification etc. Carl</p>

<p></p>

<p></p>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:http://ogp.me/ns/article#">
  
  
  
<div class="article-metadata">

  <p>
  <span class="article-date">
    <i class="fa fa-calendar"></i>
    
    <time datetime="2010-10-12 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Tue, Oct 12, 2010
    </time>
    
  </span>
  </p>
    

  <p>
  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="../../../../categories/evolution">evolution</a
    >
    
  </span>
  
  
  </p>
  
  <p>
  
  </p>

</div>

 
  <br />
  
  <p><a class="btn btn-default" rel="prev" href='../../../../2010/10/13/wednesday/'><i class="fa fa-chevron-left"></i> prev</a>
    <a class="btn btn-default" rel="next" href='../../../../2010/10/11/still-writing/'>next <i class="fa fa-chevron-right"></i></a></p>

  <br />

  <p> <a class="btn btn-default" 
         href="https://github.com/cboettig/cboettig.github.io/commits/master/content/lab-notebook/2010-10-12-a-day-of-writing.md"><i class="fa fa-clock-o"></i> history</a></p>

  <p> <i class="fa fa-barcode"></i> SHA: <a href="https://github.com/cboettig/cboettig.github.io/blob/9d9072923c46d635718a4624d6afff6b1ec2439f/content/lab-notebook/2010-10-12-a-day-of-writing.md">9d9072923</a></p> 


</aside>

    </div>
  </div>
</div>


<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'cboettig';
    var disqus_identifier = '\/2010\/10\/12\/a-day-of-writing\/';
    var disqus_title = 'a day of writing';
    var disqus_url = '\/2010\/10\/12\/a-day-of-writing\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>

<footer class="site-footer">
  <hr />
  <div class="container">

  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://carlboettiger.info/#me">
      <p>
      <script type="text/javascript" src="../../../../js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
           <a rel="foaf:weblog" type="application/atom+xml" href="../../../../index.xml"  
        class="showtooltip" title="RSS feeds for my blog-style entries." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    


    <div class="col-md-4 col-md-offset-1 col-xs-4">
	    <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="../../../../img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="../../../../img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>
</footer>


    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="../../../../js/jquery-1.12.3.min.js"></script>
    <script src="../../../../js/bootstrap.min.js"></script>
    <script src="../../../../js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="../../../../js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-18401403-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

 
