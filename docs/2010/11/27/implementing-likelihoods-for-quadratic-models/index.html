<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.20.2" />
  <meta name="author" content="Carl Boettiger">
  

  
  
  
    
    
    <link rel="stylesheet" href="../../../../css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="../../../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../../css/font-awesome.min.css">
  <link rel="stylesheet" href="../../../../css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  
  
    <link rel="stylesheet" href="../../../../css/cboettig.css">
  
  
  <link rel="alternate" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">
  <link rel="feed" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">

  <link rel="icon" type="image/png" href="../../../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../../img/apple-touch-icon.png">
  <link rel="canonical" href="../../../../2010/11/27/implementing-likelihoods-for-quadratic-models/">


  <title>Implementing Likelihoods for quadratic models | Boettiger Group</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../../">Boettiger Group</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="../../../../index.html">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../members/">
            
            <span>Members</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../vita/">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../teaching/">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../lab-notebook">
            
            <span>Lab Notebook</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    <h1>Implementing Likelihoods for quadratic models</h1> 
      
    

<p>Working from the quadratic model for the saddle node bifurcation rather than the linear (OU) model.  Recall that the dynamics are:</p>

<p>$$dX = \left( r - (x-\theta)^2\right)dt + \beta \sqrt{X} dB_t $$</p>

<p>and the linear noise approximation gives a linear Fokker Planck equation such that the probability distribution is Gaussian with moments ((corrected from yesterday to scale noise, basically as pure-birth Poisson process))</p>

<p>$$\frac{d \hat{x}}{dt} &amp;= r - (\hat{x}-\theta)^2 $$
$$ \frac{d \sigma^2}{dt} &amp;= -2 (\hat x - \theta )\sigma^2 + \beta \left(r - (\hat{x}-\theta)^2 \right)   $$</p>

<p>So we can evaluate the probability density of being at $ x_t$ at time <em>t</em> given that we started at _x<em>0</em> at time 0 by integrating the above equations (numerically, in this case, as we lack a closed form solution for the above).</p>

<p>Being able to calculate this probability we can easily calculate likelihood of the timeseries under the model.  We code this in R (<a href="https://github.com/cboettig/structured-populations/commit/59a712f2ca7527ccd33ecd272729d29df7cac3d7#diff-0">likelihood_bifur_models.R</a>) and write a quick example script (also in repo as <a href="https://github.com/cboettig/structured-populations/commit/59a712f2ca7527ccd33ecd272729d29df7cac3d7#diff-1">bifur_likelihood_ex.R</a>):</p>

<pre><code class="language-r">
pars = c(r=10, theta=3, beta=1)
m &lt;- init_sdemodel(pars =pars, Xo = 6.2, model=&quot;SN&quot;, N=200)
X &lt;- simulate.SN(m)
# Set initial guess
m$pars &lt;- c(r=11,theta=4,beta=1)
out &lt;- update.SN(m, X, method=&quot;SANN&quot;)

</code></pre>

<p>Exploring different fitting, seems to be a challenge.  For instance, finds wrong optimum sometimes &ndash; perhaps due to a bug somewhere (see more examples in flickr stream):
<img src="http://farm5.staticflickr.com/4083/5213027405_7927655f38_o.png" alt="" /></p>

<p>As likelihood surface (shown here for theta) appears challenging:</p>

<p><img src="http://farm6.staticflickr.com/5161/5213358725_a5071f4571_o.png" alt="" /></p>

<p>and numerical errors make it worse:</p>

<p><img src="http://farm5.staticflickr.com/4087/5213376911_7ba94180e2_o.png" alt="" /></p>

<p><img src="http://farm6.staticflickr.com/5081/5215261656_f8c9f04b2e_o.png" alt="" /></p>

<p>Never the less, the fit does okay when the initial condition for theta starts nearer the better well (right).  See flickr library for more examples and git for code.  Still not obvious why the unstable equilibrium is quite such a likelihood peak, but anyway&hellip;</p>

<p>Success of fits varies quite a bit, depending on data, initial guesses for parameters, etc.  Note that for many of these the optimization fails to converge (more reasons discussed below).</p>

<p>[flickr-gallery mode=&ldquo;tag&rdquo; tags=&ldquo;quadraticfitslides&rdquo; tag_mode=&ldquo;all&rdquo;]</p>

<h3 id="improving-automated-recording-in-figures">Improving automated recording in figures</h3>

<p>Have added a git commit message to the reporting, so that flickr images are automatically tagged with a commit stamp referring to the script which produced them:</p>

<pre><code class="language-r">
gitcom &lt;- system('git commit -a -m &quot;autocommit&quot;', intern=TRUE)
# only first line of git commit commandline return will be printed in flickr discription
system(paste('flickr_upload --tag=&quot;stochpop bifurcation&quot;', '--description=&quot;', gitcom, '&quot;',  ' saddle_node_fit.png'))
system(paste('hpc-autotweets &quot;', gitcom, ' done&quot;'))

</code></pre>

<p>Would be nice to eventually make this a link.  Also still good to print the most interesting parameters directly on the figure (or in the description if that isn&rsquo;t appropriate) so that one doesn&rsquo;t have to reference the code.  Wonder if I can dump a larger text output into a single continuous string for the description.</p>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:http://ogp.me/ns/article#">
  
  
  
<div class="article-metadata">

  <p>
  <span class="article-date">
    <i class="fa fa-calendar"></i>
    
    <time datetime="2010-11-27 11:09:06 &#43;0000 UTC" itemprop="datePublished">
      Sat, Nov 27, 2010
    </time>
    
  </span>
  </p>
    

  <p>
  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="../../../../categories/ecology">ecology</a
    >
    
  </span>
  
  
  </p>
  
  <p>
  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="../../../../tags/warning-signals">warning-signals</a
    >
    
  </span>
  
  
  </p>

</div>

 
  <br />
  
  <p><a class="btn btn-default" rel="prev" href='../../../../2010/11/28/likelihoods-for-quadratic-models-cont/'><i class="fa fa-chevron-left"></i> prev</a>
    <a class="btn btn-default" rel="next" href='../../../../2010/11/25/tweets-from-an-ecology-field-class/'>next <i class="fa fa-chevron-right"></i></a></p>

  <br />

  <p> <a class="btn btn-default" 
         href="https://github.com/cboettig/cboettig.github.io/commits/master/content/lab-notebook/2010-11-27-implementing-likelihoods-for-quadratic-models.md"><i class="fa fa-clock-o"></i> history</a></p>

  <p> <i class="fa fa-barcode"></i> SHA: <a href="https://github.com/cboettig/cboettig.github.io/blob/2785abfe840b0094f2f939c64e6647ff25f766c8/content/lab-notebook/2010-11-27-implementing-likelihoods-for-quadratic-models.md">2785abfe8</a></p> 


</aside>

    </div>
  </div>
</div>


<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'cboettig';
    var disqus_identifier = '\/2010\/11\/27\/implementing-likelihoods-for-quadratic-models\/';
    var disqus_title = 'Implementing Likelihoods for quadratic models';
    var disqus_url = '\/2010\/11\/27\/implementing-likelihoods-for-quadratic-models\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>

<footer class="site-footer">
  <hr />
  <div class="container">

  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://carlboettiger.info/#me">
      <p>
      <script type="text/javascript" src="../../../../js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
           <a rel="foaf:weblog" type="application/atom+xml" href="../../../../index.xml"  
        class="showtooltip" title="RSS feeds for my blog-style entries." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    


    <div class="col-md-4 col-md-offset-1 col-xs-4">
	    <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="../../../../img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="../../../../img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>
</footer>


    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="../../../../js/jquery-1.12.3.min.js"></script>
    <script src="../../../../js/bootstrap.min.js"></script>
    <script src="../../../../js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="../../../../js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-18401403-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

 
