<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.21-DEV" />
  <meta name="author" content="Carl Boettiger">
  

  
  
  
    
    
    <link rel="stylesheet" href="../../../css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="../../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../css/font-awesome.min.css">
  <link rel="stylesheet" href="../../../css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  
  
    <link rel="stylesheet" href="../../../css/cboettig.css">
  
  
  <link rel="alternate" href="../../../index.xml" type="application/rss+xml" title="Boettiger Group">
  <link rel="feed" href="../../../index.xml" type="application/rss+xml" title="Boettiger Group">

  <link rel="icon" type="image/png" href="../../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../img/apple-touch-icon.png">
  <link rel="canonical" href="../../../2010/11/28/likelihoods-for-quadratic-models-cont.html">


  <title>Likelihoods for quadratic models cont | Boettiger Group</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../">Boettiger Group</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="../../../index.html">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../members/">
            
            <span>Members</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../vita/">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../teaching/">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../lab-notebook">
            
            <span>Lab Notebook</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    <h1>Likelihoods for quadratic models cont</h1> 
      
    

<p>Considering the fits of the quadratic models from yesterday.</p>

<p>[flickr-gallery mode=&ldquo;tag&rdquo; tags=&ldquo;quadraticfitslides&rdquo; tag_mode=&ldquo;all&rdquo;]</p>

<h3 id="analysis-of-fits">Analysis of fits</h3>

<p>Of course these fits rely entirely on mapping the location of the stable point and the slope through that point, something they still cannot do all that well.  In this parameterization the the stable intercept is
$$ \hat x = \sqrt{r}+\theta $$
and slope at intercept is
$$ \frac{\partial f(\hat x)}{\partial x} = -2\sqrt{r} $$
This creates a numerical optimization problem, since there is high importance on getting the mean right, and less on the variance, the routine tends to fix the combination of r and theta to get the mean right, and then cannot change r to get the slope correct without getting penalized for the loss of likelihood in changing the mean.</p>

<p><img src="http://farm6.staticflickr.com/5290/5214829217_0afe62cbd1_o.png" alt="" /></p>

<h3 id="comparing-to-estimating-linearization-provokes-a-tweak-of-the-model">Comparing to estimating linearization provokes a tweak of the model</h3>

<p>For this reason would be easier to estimate the OU model directly, and apply the transformation into the equivalent quadratic model.</p>

<p>$$ \theta<em>{ou} = \sqrt{r}+\theta</em>{sn} $$
$$ \alpha<em>{ou}  = 2\sqrt{r} $$
$$ \theta</em>{sn} = \theta<em>{ou}- \alpha</em>{ou}/2 $$
$$ r = \alpha_{ou}^<sup>2</sup>&frasl;<sub>4</sub> $$</p>

<p>and the variance is slightly more complicated:
$$
\frac{ \beta \left(r - (\hat{x}-\theta<em>{sn})^2 \right)}{2 (\hat x - \theta</em>{sn} )}  = \frac{\sigma^2<em>{ou}}{2\alpha} ]
$$ \beta = \frac{\sigma^2</em>{ou}(\hat x - \theta<em>{sn} )}{\alpha \left(r - (\hat{x}-\theta</em>{sn})^2 \right)} $$
[ \beta = \frac{\sigma^2<em>{ou}\sqrt{r} }{\alpha \left(r - (\hat{x}-\theta</em>{sn})^2 \right)}
$$</p>

<p>Note that the denominator goes to zero &ndash; the SN model as framed above as pure birth has no noise at the equilibrium.  Let&rsquo;s alter this in the simulation, phrased as a birth-death model, perhaps just reversing the sign on the quadratic term, we get a more meaningful:</p>

<p>$$
\beta = \frac{\sigma^2<em>{ou}\sqrt{r} }{\alpha \left(r + (\hat{x}-\theta</em>{sn})^2 \right)} ]
[ \beta = \frac{\sigma^2_{ou} }{2 \alpha\sqrt{r} }
$$</p>

<p>This implies much larger noise of course, and does seem to provide better estimates.  On the right repeated with smaller noise values (see beta parameter estimates).</p>

<p><img src="http://farm6.staticflickr.com/5282/5215141381_5b4897c13e_o.png" alt="" /></p>

<p><img src="http://farm6.staticflickr.com/5241/5215195079_5ea8c1f2d2_o.png" alt="" /></p>

<p>Note that less noise also means less accurate estimate farther out.  The Nelder-Meade algorithm is now happy with the convergence:</p>

<pre><code>&gt; out$optim_output$convergence
[1] 0
</code></pre>

<h4 id="so-how-does-this-compare-to-estimating-by-ou">So how does this compare to estimating by OU?</h4>

<p>We estimate the OU model and then infer the quadratic model using the equations derived above:</p>

<p><img src="http://farm6.staticflickr.com/5170/5215272745_50f3492dca_o.png" alt="" /></p>

<p>(<a href="https://github.com/cboettig/structured-populations/commit/61439ad03cf7d623c8bf94b74d950a81dc56602f">code</a>)</p>

<p>So despite the numerical challenges in estimating the quadratic directly, when it can converge it can do quite well; better than the linear fit.  This new noise model does much better at handling the case of starting at the far side of the equilibrium, as theta surface is now monotonic since noise doesn&rsquo;t vanish at the unstable equilibrium:</p>

<p><img src="http://farm5.staticflickr.com/4112/5215303415_f785c52d8d_o.png" alt="" /></p>

<p><img src="http://farm6.staticflickr.com/5163/5216262847_640f1be758_o.png" alt="" /></p>

<p>On the right we see that the transformed linear model can still well outperform the quadratic due to the degeneracy we discussed earlier in choosing r and theta (right).  In general it may be best to use the linear fitting routine as an initial condition if not as a replacement for the quadratic model.</p>

<h3 id="model-generality">Model generality</h3>

<p>The nice thing about the quadratic formulation (despite having to numerically integrate an ode system instead of use an analytical solution for the conditional probability) is the natural representation of the changing r version in this model.</p>

<p>This doesn&rsquo;t allow different rates of the bifurcation with change in <em>r</em>.  This would require a coefficient to the quadratic,
$$ f(x) = r - a(x-\theta)^2 $$
$$ \hat x = \sqrt{r/a}+\theta $$
$$ \partial f(\hat x) = -2\sqrt{a r} $$</p>

<p>and would be an identifiability issue.</p>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:http://ogp.me/ns/article#">
  
  
  
<div class="article-metadata">

  <p>
  <span class="article-date">
    <i class="fa fa-calendar"></i>
    
    <time datetime="2010-11-28 21:14:09 &#43;0000 UTC" itemprop="datePublished">
      Sun, Nov 28, 2010
    </time>
    
  </span>
  </p>
    

  <p>
  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="../../../categories/ecology">ecology</a
    >
    
  </span>
  
  
  </p>
  
  <p>
  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="../../../tags/derivation">derivation</a
    >, 
    
    <a href="../../../tags/warning-signals">warning-signals</a
    >
    
  </span>
  
  
  </p>

</div>

 
  <br />
  
  <p><a class="btn btn-default" rel="prev" href='../../../2010/11/29/challenges-in-estimating-phylogenetic-signal.html'><i class="fa fa-chevron-left"></i> prev</a>
    <a class="btn btn-default" rel="next" href='../../../2010/11/27/implementing-likelihoods-for-quadratic-models.html'>next <i class="fa fa-chevron-right"></i></a></p>

  <br />

  <p> <a class="btn btn-default" 
         href="https://github.com/cboettig/cboettig.github.io/commits/master/content/lab-notebook/2010-11-28-likelihoods-for-quadratic-models-cont.md"><i class="fa fa-clock-o"></i> history</a></p>

  <p> <i class="fa fa-barcode"></i> SHA: <a href="https://github.com/cboettig/cboettig.github.io/blob/2785abfe840b0094f2f939c64e6647ff25f766c8/content/lab-notebook/2010-11-28-likelihoods-for-quadratic-models-cont.md">2785abf</a></p> 


</aside>

    </div>
  </div>
</div>


<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'cboettig';
    var disqus_identifier = '\/2010\/11\/28\/likelihoods-for-quadratic-models-cont.html';
    var disqus_title = 'Likelihoods for quadratic models cont';
    var disqus_url = '\/2010\/11\/28\/likelihoods-for-quadratic-models-cont.html';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>

<footer class="site-footer">
  <hr />
  <div class="container">

  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://carlboettiger.info/#me">
      <p>
      <script type="text/javascript" src="../../../js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
           <a rel="foaf:weblog" type="application/atom+xml" href="../../../index.xml"  
        class="showtooltip" title="RSS feeds for my blog-style entries." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    


    <div class="col-md-4 col-md-offset-1 col-xs-4">
	    <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="../../../img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="../../../img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>
</footer>


    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="../../../js/jquery-1.12.3.min.js"></script>
    <script src="../../../js/bootstrap.min.js"></script>
    <script src="../../../js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="../../../js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-18401403-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

 
