<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.20.2" />
  <meta name="author" content="Carl Boettiger">
  

  
  
  
    
    
    <link rel="stylesheet" href="../../../../css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="../../../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../../css/font-awesome.min.css">
  <link rel="stylesheet" href="../../../../css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  
  
    <link rel="stylesheet" href="../../../../css/cboettig.css">
  
  
  <link rel="alternate" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">
  <link rel="feed" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">

  <link rel="icon" type="image/png" href="../../../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../../img/apple-touch-icon.png">
  <link rel="canonical" href="../../../../1/01/01/additional-sources-of-noise-sethi-2005/">


  <title>Additional sources of noise (Sethi 2005) | Boettiger Group</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../../">Boettiger Group</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="../../../../index.html">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../members/">
            
            <span>Members</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../vita/">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../teaching/">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../lab-notebook">
            
            <span>Lab Notebook</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    <h1>Additional sources of noise (Sethi 2005)</h1> 
      
    

<h1 id="sethi-model">Sethi Model</h1>

<ul>
<li>author Carl Boettiger, <a href="mailto:cboettig@gmail.com">cboettig@gmail.com</a></li>
<li>license: CC0</li>
</ul>

<p>Implements a numerical version of the SDP described in (Sethi <em>et. al.</em> 2005).</p>

<p>Clear the workspace and load package dependencies:</p>

<p>Define noise parameters</p>

<pre><code class="language-r">sigma_g &lt;- 0.1    # Noise in population growth
sigma_m &lt;- 0.1     # noise in stock assessment measurement
sigma_i &lt;- 0.1     # noise in implementation of the quota
</code></pre>

<p>we&rsquo;ll use log normal noise functions.
For Reed, only <code>z_g</code> will be random.
Sethi et al will add the other forms of noise:</p>

<pre><code class="language-r">z_g &lt;- function() rlnorm(1,  0, sigma_g) # mean 1
z_m &lt;- function() rlnorm(1,  0, sigma_m) # mean 1
z_i &lt;- function() rlnorm(1,  0, sigma_i) # mean 1
</code></pre>

<p>Chose the state equation / population dynamics function</p>

<pre><code class="language-r">f &lt;- BevHolt
</code></pre>

<p>Note that the <code>pdg-control</code> pacakge already has a definition for the <code>BevHolt</code> function, (typing the function name prints the function)</p>

<pre><code class="language-r">BevHolt
</code></pre>

<pre><code>function (x, h, p) 
{
    x &lt;- max(0, x - h)
    A &lt;- p[1]
    B &lt;- p[2]
    sapply(x, function(x) {
        x &lt;- max(0, x)
        max(0, A * x/(1 + B * x))
    })
}
&lt;environment: namespace:pdgControl&gt;
</code></pre>

<p>That is, \( f(x,h) = \frac{A x}{1 + B x} \)</p>

<p>Of course we could pass in any custom function of stocksize <code>x</code>, harvest <code>h</code> and parameter vector <code>p</code> in place of <code>BevHolt</code>.  Note that we would need to write this function explicitly so that it can take vector values of <code>x</code> (i.e. uses <code>sapply</code>), an annoying feature of <code>R</code> for users comming from Matlab.</p>

<p>We must now define parameters for the function.  Note that the positive stationary root of the model is given by \( \frac{A-1}{B} \), which we&rsquo;ll store for future reference as <code>K</code>.</p>

<pre><code class="language-r">pars &lt;- c(1.5, 0.05)
K &lt;- (pars[1] - 1)/pars[2]
</code></pre>

<p>and we use a harvest-based profit function with default parameters</p>

<pre><code class="language-r">profit &lt;- profit_harvest(price=1, c0 = 0.01) 
</code></pre>

<p>The <code>profit_harvest</code> function has the form</p>

<p>\[ \Pi = h - \left( c_0  + c_1 \frac{h}{x} \right) \frac{h}{x} \]</p>

<p>conditioned on \( h &gt; x \) and \(x &gt; 0 \).  Note that the R code defines a function from another function using a trick known as a <em>closure</em>.  Again we could write a custom profit function as long as it can take a vector stock size <code>x</code> and a scalar harvest level <code>h</code>.  Details for provided functions can be found in the manual, i.e. <code>?profit_harvest</code>.</p>

<p>Now we must set up the discrete grids for stock size and havest levels (which will use same resolution as for stock), in order to calculate the SDP solution.   Here we set the gridsize to 100.</p>

<pre><code class="language-r">x_grid &lt;- seq(0, 2 * K, length = 100)  
h_grid &lt;- x_grid  
</code></pre>

<h3 id="calculate-the-transition-matrix-with-noise-in-growth-only">Calculate the transition matrix (with noise in growth only)</h3>

<p>We calculate the stochastic transition matrix for the probability of going from any state \( x_t \)
to any other state \( x_t+1 \) the following year,
for each possible choice of harvest \( h_t \). This provides a look-up table for the dynamic programming calculations.</p>

<p>In the Sethi case, computing the distribution over multiple sources of noise is actually quite difficult.  Simulation turns out to be more efficient than numerically integrating over each distribution.  This code parallelizes the operation over four cores, but can be scaled to an arbitrary cluster.</p>

<pre><code class="language-r">require(snowfall) 
sfInit(parallel=TRUE, cpu=4)
SDP_Mat &lt;- SDP_by_simulation(f, pars, x_grid, h_grid, z_g, z_m, z_i, reps=999)
</code></pre>

<pre><code>Library ggplot2 loaded.
</code></pre>

<p>Note that <code>SDP_Mat</code> is specified from the calculation above, as are our grids and our profit function. <code>OptTime</code> is the stopping time.  <code>xT</code> specifies a boundary condition at the stopping time. A reward for meeting this boundary must be specified for it to make any difference.  <code>delta</code> indicates the economic discount rate. Again, details are in the function documentation.</p>

<h3 id="find-the-optimum-by-dynamic-programming">Find the optimum by dynamic programming</h3>

<p>Bellman&rsquo;s algorithm to compute the optimal solution for all possible trajectories.</p>

<pre><code class="language-r">opt &lt;- find_dp_optim(SDP_Mat, x_grid, h_grid, OptTime=25, xT=0, 
                     profit, delta=0.05, reward=0)
</code></pre>

<h3 id="simulate">Simulate</h3>

<p>Now we&rsquo;ll simulate 100 replicates of this stochastic process under the optimal harvest policy determined above.</p>

<pre><code class="language-r">sims &lt;- lapply(1:100, function(i){
  ForwardSimulate(f, pars, x_grid, h_grid, x0=K, opt$D, z_g, z_m, z_i)
})
</code></pre>

<p>The forward simulation algorithm needs an initial condition <code>x0</code> which we set equal to the carrying capacity, as well as our population dynamics <code>f</code>, parameters <code>pars</code>, grids, and noise coefficients.  Recall in the Reed case only <code>z_g</code>, growth, is stochastic, while in the Sethi example we now have three forms of stochasticity &ndash; growth, measurement, and implementation.</p>

<h2 id="summarize-and-plot-the-results">Summarize and plot the results</h2>

<p>R makes it easy to work with this big replicate data set.  We make data tidy (melt), fast (data.tables), and nicely labeled.</p>

<pre><code class="language-r">dat &lt;- melt(sims, id=names(sims[[1]]))  
dt &lt;- data.table(dat)
setnames(dt, &quot;L1&quot;, &quot;reps&quot;) # names are nice
</code></pre>

<h3 id="plots">Plots</h3>

<p>Let&rsquo;s begin by looking at the dynamics of a single replicate. The line shows Reed&rsquo;s S, the level above which the stock should be harvested (where catch should be the difference between stock and S).  To confirm that this policy is being followed, note that harvesting only occurs when the stock is above this line, and harvest is proportional to the amount by which it is above.  Change the replicate <code>reps==</code> to see the results from a different replicate.</p>

<pre><code class="language-r">ggplot(subset(dt,reps==1)) +
  geom_line(aes(time, fishstock)) +
  geom_abline(intercept=opt$S, slope = 0) +
  geom_line(aes(time, harvest), col=&quot;darkgreen&quot;) 
</code></pre>

<p><img src="http://farm9.staticflickr.com/8007/7130135757_09c23e3e5a_o.png" alt="plot of chunk onerep" /></p>

<p>This plot summarizes the stock dynamics by visualizing the replicates. Reed&rsquo;s S shown again.</p>

<pre><code class="language-r">p1 &lt;- ggplot(dt) + geom_abline(intercept=opt$S, slope = 0) 
p1 + geom_line(aes(time, fishstock, group = reps), alpha = 0.2)
</code></pre>

<p><img src="http://farm9.staticflickr.com/8148/6984061776_d15e7d073f_o.png" alt="plot of chunk all" /></p>

<p>We can also look at the harvest dynamics:</p>

<pre><code class="language-r">p1 + geom_line(aes(time, harvest, group = reps), alpha = 0.1, col=&quot;darkgreen&quot;)
</code></pre>

<p><img src="http://farm8.staticflickr.com/7188/6984052718_6e932cedf8_o.png" alt="plot of chunk harvestplot" /></p>

<p>This strategy is supposed to be a constant-escapement strategy. We can visualize the escapement:</p>

<pre><code class="language-r">p1 + geom_line(aes(time, escapement, group = reps), alpha = 0.1, col=&quot;darkgrey&quot;)
</code></pre>

<p><img src="http://farm8.staticflickr.com/7096/6984052922_b4ab50f14b_o.png" alt="plot of chunk escapement" /></p>

<h3 id="visualizing-the-optimal-policy">Visualizing the optimal policy</h3>

<p>Note that when the boundary is sufficiently far away, i.e. for the first couple timesteps, the optimal policy is stationary.  The optimal policy is shown here over time, where the color indicates the harvest recommended for each possible stock value at that time (shown on the vertical axis). Observe that the solution does not correspond to a simple Reed-style rule.</p>

<pre><code class="language-r">policy &lt;- melt(opt$D)
policy_zoom &lt;- subset(policy, x_grid[Var1] &lt; max(dt$fishstock) )
p5 &lt;- ggplot(policy_zoom) + 
  geom_point(aes(Var2, (x_grid[Var1]), col=h_grid[value])) + 
  labs(x = &quot;time&quot;, y = &quot;fishstock&quot;) +
  scale_colour_gradientn(colours = rainbow(4)) +
  geom_abline(intercept=opt$S, slope = 0) 
p5
</code></pre>

<p><img src="http://farm8.staticflickr.com/7198/7130146133_bf7083f9d2_o.png" alt="plot of chunk policy" /></p>

<p>The harvest intensity is limited by the stock size.</p>

<pre><code class="language-r">p6 &lt;- ggplot(policy_zoom) + 
  geom_point(aes(Var2, (x_grid[Var1]), col=x_grid[Var1] - h_grid[value])) + 
  labs(x = &quot;time&quot;, y = &quot;fishstock&quot;) +
  scale_colour_gradientn(colours = rainbow(4)) +
  geom_abline(intercept=opt$S, slope = 0) 
p6 + geom_line(aes(time, fishstock, group = reps), alpha = 0.1, data=dt)
</code></pre>

<p><img src="http://farm9.staticflickr.com/8007/6984063036_ea9d9ac47d_o.png" alt="plot of chunk policy2" /></p>

<h2 id="references">References</h2>

<p>Sethi G, Costello C, Fisher A, Hanemann M and Karp L (2005).
&ldquo;Fishery management under multiple uncertainty.&rdquo; <em>Journal of
Environmental Economics and Management</em>, <em>50</em>. ISSN 00950696,
<a href="http://dx.doi.org/10.1016/j.jeem.2004.11.005">http://dx.doi.org/10.1016/j.jeem.2004.11.005</a></p>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:http://ogp.me/ns/article#">
  
  
  
<div class="article-metadata">

  <p>
  <span class="article-date">
    <i class="fa fa-calendar"></i>
    
    <time datetime="0001-01-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Mon, Jan 1, 0001
    </time>
    
  </span>
  </p>
    

  <p>
  
  </p>
  
  <p>
  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="../../../../tags/decision-theory">decision-theory</a
    >
    
  </span>
  
  
  </p>

</div>

 
  <br />
  
  <p><a class="btn btn-default" rel="prev" href='../../../../1/01/01/adaptive-dynamics-updates/'><i class="fa fa-chevron-left"></i> prev</a>
    <a class="btn btn-default" rel="next" href='../../../../1/01/01/alan-meeting/'>next <i class="fa fa-chevron-right"></i></a></p>

  <br />

  <p> <a class="btn btn-default" 
         href="https://github.com/cboettig/cboettig.github.io/commits/master/content/lab-notebook/2012-04-30-Sethi.md"><i class="fa fa-clock-o"></i> history</a></p>

  <p> <i class="fa fa-barcode"></i> SHA: <a href="https://github.com/cboettig/cboettig.github.io/blob/b3630889a5584cd1240e1c9d2208759615c88af4/content/lab-notebook/2012-04-30-Sethi.md">b363088</a></p> 


</aside>

    </div>
  </div>
</div>


<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'cboettig';
    var disqus_identifier = '\/1\/01\/01\/additional-sources-of-noise-sethi-2005\/';
    var disqus_title = 'Additional sources of noise (Sethi 2005)';
    var disqus_url = '\/1\/01\/01\/additional-sources-of-noise-sethi-2005\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>

<footer class="site-footer">
  <hr />
  <div class="container">

  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://carlboettiger.info/#me">
      <p>
      <script type="text/javascript" src="../../../../js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
           <a rel="foaf:weblog" type="application/atom+xml" href="../../../../index.xml"  
        class="showtooltip" title="RSS feeds for my blog-style entries." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    


    <div class="col-md-4 col-md-offset-1 col-xs-4">
	    <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="../../../../img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="../../../../img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>
</footer>


    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="../../../../js/jquery-1.12.3.min.js"></script>
    <script src="../../../../js/bootstrap.min.js"></script>
    <script src="../../../../js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="../../../../js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-18401403-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

 
