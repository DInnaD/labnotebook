<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.20.2" />
  <meta name="author" content="Carl Boettiger">
  

  
  
  
    
    
    <link rel="stylesheet" href="../../../../css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="../../../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../../css/font-awesome.min.css">
  <link rel="stylesheet" href="../../../../css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  
  
    <link rel="stylesheet" href="../../../../css/cboettig.css">
  
  
  <link rel="alternate" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">
  <link rel="feed" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">

  <link rel="icon" type="image/png" href="../../../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../../img/apple-touch-icon.png">
  <link rel="canonical" href="../../../../1/01/01/bootstrapping-the-independent-alpha-sigma-models/">


  <title>Bootstrapping the independent alpha-sigma models | Boettiger Group</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../../">Boettiger Group</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="../../../../index.html">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../members/">
            
            <span>Members</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../vita/">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../teaching/">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../lab-notebook">
            
            <span>Lab Notebook</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    <h1>Bootstrapping the independent alpha-sigma models</h1> 
      
    

<p>I compare in a robust framework the likelihood that species mean trait
values are generated by Brownian motion, a single peak OU model, or a
model with different regimes (postulated in the literature) in which the
selective strength (alpha) and diversification rate (sigma) are fixed
across the entire tree or allowed to vary by selective regime. (Regimes
are defined as branches with different values for the selective
optimum).</p>

<p>The parametric bootstrap of the likelihood ratio statistic provides a
rigorous way to quantify the probability that the model choice is
correct: the probability that the data was produced by the test model vs
the null model is assured by the Neyman-Pearson lemma. Because the
models are nested in a natural hierarchy, pairwise tests of successively
more complicated models provide an efficient and robust way to select
between models, whereas other methods may be misleading.</p>

<h3 id="anoles-data">Anoles Data</h3>

<p>OU cannot reject BM, OU.LP (three peaks) can reject OU single peak model
(and hence BM). Allowing alpha and sigma to vary by regime shows an
improvement better then expected by chance under the global alpha/sigma
model 93% of the time, which we may take as insufficient justification
of the separate strengths of selection and diversification between
regimes.</p>

<p><img src="http://openwetware.org/images/thumb/e/ec/Wrightscape_anoles.png/800px-Wrightscape_anoles.png" alt="code" /></p>

<p><img src="../../../../skins/common/images/magnify-clip.png" alt="image" /></p>

<p><a href="http://github.com/cboettig/wrightscape/blob/b3eabf29caa6fcf5e9f5e0b54d7c0fdf5bf6a79a/R/wrightscape.R" title="http://github.com/cboettig/wrightscape/blob/b3eabf29caa6fcf5e9f5e0b54d7c0fdf5bf6a79a/R/wrightscape.R">code</a></p>

<pre><code class="language-de1">   require(wrightscape)
    data(bimac)
    tree &lt;- with(bimac,ouchtree(nodes=node,ancestors=ancestor,times=time/max(time),labels=species))
    bm &lt;- brown(log(bimac['size']), tree)
    ou1 &lt;- hansen(log(bimac['size']), tree, bimac['OU.1'], 1, 1)
    ws1 &lt;- wrightscape(log(bimac['size']), tree, bimac['OU.1'], 1, 1)
    ou2 &lt;- hansen(log(bimac['size']), tree, bimac['OU.LP'], 1, 1)
    ws2 &lt;- wrightscape(log(bimac['size']), tree, bimac['OU.LP'], (ou2@sqrt.alpha)^2, ou2@sigma)
 
    model_list &lt;- list(bm = bm, ws1 = ws1, ou2 = ou2, ws2 = ws2)
    LR &lt;- choose_model(model_list, 100)
 
    png(&quot;wrightscape_anoles.png&quot;, width = 2000, height=600)
    par(mfrow=c(1,3))
    pretty_plot(LR[[1]], main=&quot;support for OU over BM&quot;)
    pretty_plot(LR[[2]], main=&quot;support for multiple peaks over 1&quot;)
    pretty_plot(LR[[3]], main=&quot;support for differential selective strength&quot;)
    dev.off()
</code></pre>

<p></p>

<h3 id="sedges-data">Sedges Data</h3>

<p>OU model clearly rejects BM, two regimes clearly rejects the single OU
peak, and separate selective regimes appears supported at the p = 0.02
level.</p>

<p><img src="http://openwetware.org/images/thumb/2/2f/Sedges.png/800px-Sedges.png" alt="code" /></p>

<p><img src="../../../../skins/common/images/magnify-clip.png" alt="image" /></p>

<p><a href="http://github.com/cboettig/wrightscape/blob/b3eabf29caa6fcf5e9f5e0b54d7c0fdf5bf6a79a/R/wrightscape.R" title="http://github.com/cboettig/wrightscape/blob/b3eabf29caa6fcf5e9f5e0b54d7c0fdf5bf6a79a/R/wrightscape.R">code</a></p>

<pre><code class="language-de1">   require(wrightscape)
    require(maticce)
    data(carex)
    attach(carex)
 
    treedata &lt;- ape2ouch_all(ovales.tree, ovales.data)
    ou2_regimes &lt;- paintBranches(list(ovales.nodes[[2]]), treedata$tree)
    ou1_regimes &lt;- as.factor(rep(1, length(ou2_regimes) ))
    names(ou1_regimes) &lt;- names(ou2_regimes)
 
# Fit the models
    bm &lt;- brown(treedata$data, treedata$tree)
    ws1 &lt;- wrightscape(treedata$data, treedata$tree, ou1_regimes, 1, 1)
    ou2 &lt;- hansen(treedata$data, treedata$tree, ou2_regimes, 1, 1)
    ws2 &lt;- wrightscape(treedata$data, treedata$tree, ou2_regimes, (ou2@sqrt.alpha)^2, ou2@sigma)
 
    model_list &lt;- list(bm = bm, ws1 = ws1, ou2 = ou2, ws2 = ws2)
    LR &lt;- choose_model(model_list, 100)
    pretty_plot(LR[[1]], main=&quot;support for OU over BM&quot;)
    pretty_plot(LR[[2]], main=&quot;support for 2 peaks over 1&quot;)
    pretty_plot(LR[[3]], main=&quot;support for differential selective strength&quot;)
</code></pre>

<h2 id="significant-code-changes">Significant code changes</h2>

<p>Fixed handling of out-of-bounds parameters. Used to just write in the
boundary size whenever the algorithm tried to go outside the boundary,
which essentially breaks the algorithm. Now it returns a minus log
likelihood of infinity (GSL_POSINF) instead, which seems to greatly
improve the observed performance of the algorithm.</p>

<p>Should have a way to indicate whether negative values are appropriate or
not for theta parameters!</p>

<p>Simplex method convergence &ndash; still struggles with parameter rich
models. During bootstrapping a substantial number of runs will hit the
maximum number of iterations. Increased to 20,000 iterations and relaxed
error tolerance to 1e-6, which seems to mostly fix this. Method should
probably throw a warning when it hits the maximum iterations though.</p>

<h2 id="optimization">Optimization</h2>

<ul>
<li>Appropriate treatment for root parameter?</li>
<li>appropriate handling for parameter boundaries?</li>
</ul>

<p></p>

<p>simulated annealing vs simplex method</p>

<p>Add back the fast method for single regime</p>

<p>parameter global/local controls</p>

<p>R level control of search algorithm parameters</p>

<p></p>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:http://ogp.me/ns/article#">
  
  
  
<div class="article-metadata">

  <p>
  <span class="article-date">
    <i class="fa fa-calendar"></i>
    
    <time datetime="0001-01-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Mon, Jan 1, 0001
    </time>
    
  </span>
  </p>
    

  <p>
  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="../../../../categories/evolution">evolution</a
    >
    
  </span>
  
  
  </p>
  
  <p>
  
  </p>

</div>

 
  <br />
  
  <p><a class="btn btn-default" rel="prev" href='../../../../1/01/01/bootstrapping-likelihood-ratios/'><i class="fa fa-chevron-left"></i> prev</a>
    <a class="btn btn-default" rel="next" href='../../../../1/01/01/bug-fixed/'>next <i class="fa fa-chevron-right"></i></a></p>

  <br />

  <p> <a class="btn btn-default" 
         href="https://github.com/cboettig/cboettig.github.io/commits/master/content/lab-notebook/2010-07-13-Bootstrapping-the-independent-alpha-sigma-models.md"><i class="fa fa-clock-o"></i> history</a></p>

  <p> <i class="fa fa-barcode"></i> SHA: <a href="https://github.com/cboettig/cboettig.github.io/blob//content/lab-notebook/2010-07-13-Bootstrapping-the-independent-alpha-sigma-models.md"></a></p> 


</aside>

    </div>
  </div>
</div>


<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'cboettig';
    var disqus_identifier = '\/1\/01\/01\/bootstrapping-the-independent-alpha-sigma-models\/';
    var disqus_title = 'Bootstrapping the independent alpha-sigma models';
    var disqus_url = '\/1\/01\/01\/bootstrapping-the-independent-alpha-sigma-models\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>

<footer class="site-footer">
  <hr />
  <div class="container">

  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://carlboettiger.info/#me">
      <p>
      <script type="text/javascript" src="../../../../js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
           <a rel="foaf:weblog" type="application/atom+xml" href="../../../../index.xml"  
        class="showtooltip" title="RSS feeds for my blog-style entries." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    


    <div class="col-md-4 col-md-offset-1 col-xs-4">
	    <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="../../../../img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="../../../../img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>
</footer>


    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="../../../../js/jquery-1.12.3.min.js"></script>
    <script src="../../../../js/bootstrap.min.js"></script>
    <script src="../../../../js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="../../../../js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-18401403-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

 
