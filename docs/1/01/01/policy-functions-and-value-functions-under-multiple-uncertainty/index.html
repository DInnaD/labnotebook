<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.20.2" />
  <meta name="author" content="Carl Boettiger">
  

  
  
  
    
    
    <link rel="stylesheet" href="../../../../css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="../../../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../../css/font-awesome.min.css">
  <link rel="stylesheet" href="../../../../css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  
  
    <link rel="stylesheet" href="../../../../css/cboettig.css">
  
  
  <link rel="alternate" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">
  <link rel="feed" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">

  <link rel="icon" type="image/png" href="../../../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../../img/apple-touch-icon.png">
  <link rel="canonical" href="../../../../1/01/01/policy-functions-and-value-functions-under-multiple-uncertainty/">


  <title>Policy functions and value functions under multiple uncertainty | Boettiger Group</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../../">Boettiger Group</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="../../../../index.html">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../members/">
            
            <span>Members</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../vita/">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../teaching/">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../lab-notebook">
            
            <span>Lab Notebook</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    <h1>Policy functions and value functions under multiple uncertainty</h1> 
      
    

<p>Implements a numerical version of the SDP described in (Sethi <em>et. al.</em> 2005).</p>

<pre><code class="language-r">## Clear the workspace and load package dependencies: 
rm(list=ls())   
require(pdgControl)
require(reshape2)
require(ggplot2)
require(data.table)
</code></pre>

<p>We consider a Beverton Holt state equation governing population dynamics, $f(x,h) = \frac{A x}{1 + B x}$</p>

<pre><code class="language-r">f &lt;- BevHolt
</code></pre>

<p>With parameters <code>A</code> = <code>1.5</code> and <code>B</code> = <code>0.05</code>.</p>

<pre><code class="language-r">pars &lt;- c(1.5, 0.05)
K &lt;- (pars[1] - 1)/pars[2]
</code></pre>

<p>Note that the positive stationary root of the model is given by \( \frac{A-1}{B} \), or carring capacity <code>K</code> = <code>10</code>.<br />
We consider a profits from fishing to be a function of harvest <code>h</code> and stock size <code>x</code>,  \( \Pi(x,h) = h - \left( c_0  + c_1 \frac{h}{x} \right) \frac{h}{x} \), conditioned on \( h &gt; x \) and \(x &gt; 0 \),</p>

<pre><code class="language-r">price &lt;- 1
c0 &lt;- 0.01
c1 &lt;- 0
profit &lt;- profit_harvest(price=price, c0 = c0, c1=c1) 
</code></pre>

<p>with price <code>1</code>, <code>c0</code> <code>0.01</code> and <code>c1</code> <code>0</code>.</p>

<pre><code class="language-r">xmin &lt;- 0
xmax &lt;- 1.5 * K
grid_n &lt;- 100
</code></pre>

<p>We seek a harvest policy which maximizes the discounted profit from the fishery using a stochastic dynamic programming approach over a discrete grid of stock sizes from <code>0</code> to <code>15</code> on a grid of <code>100</code> points, and over an identical discrete grid of possible harvest values.</p>

<pre><code class="language-r">x_grid &lt;- seq(xmin, xmax, length = grid_n)  
h_grid &lt;- x_grid  
</code></pre>

<pre><code class="language-r">delta &lt;- 0.05
xT &lt;- 0
OptTime &lt;- 25
</code></pre>

<p>We will determine the optimal solution over a <code>25</code> time step window with boundary condition for stock at <code>0</code> and discounting rate of <code>0.05</code>.  Different scenarios introduce different assumptions about the sources of noise.  Unlike (Sethi <em>et. al.</em> 2005), we use log normal insead of uniform noise, which requires Monte Carlo integration to estimate the transition matrix.  Note that we also have a Beverton-Holt recruitment function instead of the logistic map, and differ in the precise choice of parameters for the state equation, noise, discounting, profit function, etc.</p>

<h2 id="scenarios">Scenarios</h2>

<h3 id="large-measurement-error">Large Measurement error</h3>

<pre><code class="language-r">sigma_g &lt;- 0.01    # Noise in population growth
sigma_m &lt;- 0.25     # noise in stock assessment measurement
sigma_i &lt;- 0.01     # noise in implementation of the quota
z_g &lt;- function() rlnorm(1,  0, sigma_g) # mean 1
z_m &lt;- function() rlnorm(1,  0, sigma_m) # mean 1
z_i &lt;- function() rlnorm(1,  0, sigma_i) # mean 1
</code></pre>

<pre><code class="language-r">require(snowfall) 
sfInit(parallel=TRUE, cpu=16)
</code></pre>

<pre><code>R Version:  R version 2.14.1 (2011-12-22) 

</code></pre>

<pre><code class="language-r">SDP_Mat &lt;- SDP_by_simulation(f, pars, x_grid, h_grid, z_g, z_m, z_i, reps=19999)
</code></pre>

<pre><code>Library ggplot2 loaded.
</code></pre>

<pre><code class="language-r">measure &lt;- find_dp_optim(SDP_Mat, x_grid, h_grid, OptTime=25, xT=0, 
                     profit, delta=0.05, reward=0)
</code></pre>

<h3 id="large-growth-error">Large growth error</h3>

<pre><code class="language-r">sigma_g &lt;- 0.25    # Noise in population growth
sigma_m &lt;- 0.01     # noise in stock assessment measurement
sigma_i &lt;- 0.01     # noise in implementation of the quota
z_g &lt;- function() rlnorm(1,  0, sigma_g) # mean 1
z_m &lt;- function() rlnorm(1,  0, sigma_m) # mean 1
z_i &lt;- function() rlnorm(1,  0, sigma_i) # mean 1
</code></pre>

<pre><code class="language-r">SDP_Mat &lt;- SDP_by_simulation(f, pars, x_grid, h_grid, z_g, z_m, z_i, reps=19999)
</code></pre>

<pre><code>Library ggplot2 loaded.
</code></pre>

<pre><code class="language-r">growth &lt;- find_dp_optim(SDP_Mat, x_grid, h_grid, OptTime=25, xT=0, 
                     profit, delta=0.05, reward=0)
</code></pre>

<h3 id="large-implementation-error">Large implementation error</h3>

<pre><code class="language-r">sigma_g &lt;- 0.01    # Noise in population growth
sigma_m &lt;- 0.01     # noise in stock assessment measurement
sigma_i &lt;- 0.25     # noise in implementation of the quota
z_g &lt;- function() rlnorm(1,  0, sigma_g) # mean 1
z_m &lt;- function() rlnorm(1,  0, sigma_m) # mean 1
z_i &lt;- function() rlnorm(1,  0, sigma_i) # mean 1
</code></pre>

<pre><code class="language-r">SDP_Mat &lt;- SDP_by_simulation(f, pars, x_grid, h_grid, z_g, z_m, z_i, reps=19999)
</code></pre>

<pre><code>Library ggplot2 loaded.
</code></pre>

<pre><code class="language-r">imp &lt;- find_dp_optim(SDP_Mat, x_grid, h_grid, OptTime=25, xT=0, 
                     profit, delta=0.05, reward=0)
</code></pre>

<pre><code class="language-r">require(reshape2)
policy &lt;- melt( data.frame(stock=x_grid, implementation = x_grid[imp$D[,1]], measurement = x_grid[measure$D[,1]], growth = x_grid[growth$D[,1]]), id=&quot;stock&quot;)
value &lt;-  melt(data.frame(stock=x_grid, implementation = imp$V, measurement = measure$V, growth = growth$V), id=&quot;stock&quot;)
ggplot(policy) + geom_point(aes(stock, stock-value, color=variable)) + ylab(&quot;escapement&quot;) 
</code></pre>

<p><img src="http://farm9.staticflickr.com/8151/7372557232_fe14154278_o.png" alt="plot of chunk plots" /></p>

<pre><code class="language-r">ggplot(value) + geom_point(aes(stock, value, color=variable)) + ylab(&quot;Net Present Value&quot;)
</code></pre>

<p><img src="http://farm8.staticflickr.com/7239/7187327439_cf08db1492_o.png" alt="plot of chunk plots" /></p>

<pre><code class="language-r">ggplot(policy) + geom_smooth(aes(stock, stock-value, color=variable))+ ylab(&quot;escapement&quot;) 
</code></pre>

<p><img src="http://farm8.staticflickr.com/7089/7372557594_d689df38d1_o.png" alt="plot of chunk plots" /></p>

<pre><code class="language-r">ggplot(value) + geom_smooth(aes(stock, value, color=variable)) + ylab(&quot;Net Present Value&quot;)
</code></pre>

<p><img src="http://farm9.staticflickr.com/8014/7187327805_62635271fa_o.png" alt="plot of chunk plots" /></p>

<p>Note that growth noise gives the constant escapement solution, as expected, but large measurement noise results in raising the maximum escapement, particularly at large stock sizes.  If the measured population was unusually high you might assume it was a measurement error and not increase your target harvest immediately, so this makes some intuitive sense.</p>

<ul>
<li>author Carl Boettiger, <a href="mailto:cboettig@gmail.com">cboettig@gmail.com</a></li>
<li>license: CC0</li>
<li>A dynamic document generated with knitr</li>
</ul>

<h1 id="references">References</h1>

<p>Sethi G, Costello C, Fisher A, Hanemann M and Karp L (2005).
&ldquo;Fishery Management Under Multiple Uncertainty.&rdquo; <em>Journal of
Environmental Economics And Management</em>, <em>50</em>. ISSN 00950696,
<a href="http://dx.doi.org/10.1016/j.jeem.2004.11.005">doi:10.1016/j.jeem.2004.11.005</a></p>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:http://ogp.me/ns/article#">
  
  
  
<div class="article-metadata">

  <p>
  <span class="article-date">
    <i class="fa fa-calendar"></i>
    
    <time datetime="0001-01-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Mon, Jan 1, 0001
    </time>
    
  </span>
  </p>
    

  <p>
  
  </p>
  
  <p>
  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="../../../../tags/decision-theory">decision-theory</a
    >, 
    
    <a href="../../../../tags/multiple-uncertainty">multiple-uncertainty</a
    >
    
  </span>
  
  
  </p>

</div>

 
  <br />
  
  <p><a class="btn btn-default" rel="prev" href='../../../../1/01/01/phylogenetics-workshop-day-5/'><i class="fa fa-chevron-left"></i> prev</a>
    <a class="btn btn-default" rel="next" href='../../../../1/01/01/post-workshop/'>next <i class="fa fa-chevron-right"></i></a></p>

  <br />

  <p> <a class="btn btn-default" 
         href="https://github.com/cboettig/cboettig.github.io/commits/master/content/lab-notebook/2012-06-13-Sethi-policy-functions.md"><i class="fa fa-clock-o"></i> history</a></p>

  <p> <i class="fa fa-barcode"></i> SHA: <a href="https://github.com/cboettig/cboettig.github.io/blob//content/lab-notebook/2012-06-13-Sethi-policy-functions.md"></a></p> 


</aside>

    </div>
  </div>
</div>


<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'cboettig';
    var disqus_identifier = '\/1\/01\/01\/policy-functions-and-value-functions-under-multiple-uncertainty\/';
    var disqus_title = 'Policy functions and value functions under multiple uncertainty';
    var disqus_url = '\/1\/01\/01\/policy-functions-and-value-functions-under-multiple-uncertainty\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>

<footer class="site-footer">
  <hr />
  <div class="container">

  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://carlboettiger.info/#me">
      <p>
      <script type="text/javascript" src="../../../../js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
           <a rel="foaf:weblog" type="application/atom+xml" href="../../../../index.xml"  
        class="showtooltip" title="RSS feeds for my blog-style entries." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    


    <div class="col-md-4 col-md-offset-1 col-xs-4">
	    <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="../../../../img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="../../../../img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>
</footer>


    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="../../../../js/jquery-1.12.3.min.js"></script>
    <script src="../../../../js/bootstrap.min.js"></script>
    <script src="../../../../js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="../../../../js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-18401403-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

 
