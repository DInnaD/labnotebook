<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.20.2" />
  <meta name="author" content="Carl Boettiger">
  

  
  
  
    
    
    <link rel="stylesheet" href="../../../../css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="../../../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../../css/font-awesome.min.css">
  <link rel="stylesheet" href="../../../../css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  
  
    <link rel="stylesheet" href="../../../../css/cboettig.css">
  
  
  <link rel="alternate" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">
  <link rel="feed" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">

  <link rel="icon" type="image/png" href="../../../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../../img/apple-touch-icon.png">
  <link rel="canonical" href="../../../../2011/04/29/friday-notes-on-labrids-notes-on-transforms-and-size-corrections/">


  <title>Friday: Notes on Labrids, notes on Transforms and size-corrections | Boettiger Group</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../../">Boettiger Group</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="../../../../index.html">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../members/">
            
            <span>Members</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../vita/">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../teaching/">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../lab-notebook">
            
            <span>Lab Notebook</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    <h1>Friday: Notes on Labrids, notes on Transforms and size-corrections</h1> 
      
    

<p>The specific traits were:</p>

<p>Oral Jaw traits</p>

<ol>
<li><p>mouth-closing lever ratio (Close),</p></li>

<li><p>mouth-opening lever ratio (Open), kinematic</p></li>

<li><p>transmission coefficient of the oral jaws four-bar linkage (Jaw KT),</p></li>

<li><p>adductor mandibulae (AM) muscle mass,</p></li>

<li><p>premaxillary protrusion distance (Prot),</p></li>

<li><p>gape width (Gape),</p></li>
</ol>

<p>Exterior to the Oral Jaws, not expected to become unconstrained:</p>

<ul>
<li><p>levator posterior (LP) muscle mass: (Pharyngeal jaw muscle)</p></li>

<li><p>sterno-hyoideus (SH) muscle mass, (Primarily buccual cavity)</p></li>

<li><p>adult body mass (Body mass).</p></li>
</ul>

<p>See (WAINWRIGHT <em>et. al.</em> 2004).</p>

<p>Species: 122 in dataset (34 parrotfish, 88 wrasses)</p>

<p>Species in phylogeny: 34 parrotfish. 80 wrasses.  Hmm, my phylogeny is missing 8 wrasses.</p>

<h2 id="transforms">Transforms</h2>

<p>In (Price <em>et. al.</em> 2010), all linear lengths are log-transformed, masses are log transformed after cube-root transform.  Why: An assumption of linear growth with percent, combined with an allometry that makes all linear dimensions increase together (hence mass increases by the cube of any increase in a length).  Should evolution really preserve such an allometry? Does the cube root matter, since it&rsquo;s just a multiplicative scaling constant once we are in log space?</p>

<p>What about the lever ratios?  assume they are untransformed?  Also uncorrected for mass?</p>

<p>These log-transformed traits are then used to compute contrasts.  Contrasts are regressed through the origin against body-mass. This regression is then used to get residuals of the log-traits, and these residuals are modeled as BM or OU, etc.</p>

<p>Size-correction can seem rather challenging.  Of course evolution of different traits (rates of evolution, shifts, etc) are correlated, and as most traits couple strongly to size and size explains a great deal of disparity, lack of size-corrections risk data that appears to be, say, showing shifts in rate of jaw evolution when it instead shows shifts in the rate of body-size evolution.  Hence the need for size correction.</p>

<p>A common though non-ideal method is a linear regression of log-trait values against log-size.  This regression assumes that you have a bunch of measurements of (tooth size, body size) which are independent of each other.  Because of the phylogeny, you don&rsquo;t (the classic Felsenstein 1985 situation).  The standard approach leaves you with independent contrasts, not the traits themselves.  Recall that we just want to do the regression correctly, we weren&rsquo;t ready to remove the effect of phylogeny, since we&rsquo;re still gearing up to do a comparative method .</p>

<p>Revell takes great care to address this issue, (Revell, 2009) demonstrating how we get corrected values of the traits themselves, rather than being left with contrasts.</p>

<blockquote>
<p>Types of analyses that might require transformed values for tip species include (but are not limited to): the estimation of phylogenetic signal (Freckleton et al. 2002; Blomberg et al. 2003); ancestral state reconstruction (Schluter et al. 1997); the phylogenetic analysis of variance (ANOVA) or analysis of covariance (ANCOVA) (Garland et al. 1993); and phylogenetic regression in which both slope and intercept (or prediction in the species space) are of concern (Rohlf 2001).</p>
</blockquote>

<p>Getting the size-correction using the phylogeny does not mean that we are done with the phylogeny &ndash; the size-corrected values trait still have phylogenetic correlations, this just means we did the linear regression correctly in order to size correct in the first place, which as Revell cites, may not be the right way to size correct anyway, see Garcia_Berthou (2001), Freckleton(2002, 2009).</p>

<p>This attempts to correct for body-mass in a phylogenetic manner &ndash; under the assumptions:</p>

<p>(a) There is a linear relationship between body mass and other traits $ \frac{1}{3}\log(\text{body mass}) \sim \beta \log(\text{length})$</p>

<p>(b) Though the relationship comes from a functional constraint, samples from a phylogeny aren&rsquo;t independent &ndash; giving us a false representation of power.</p>

<p>At this stage we aren&rsquo;t trying to create independent samples of the functional process that connects to traits.  We just want to identify what quantity we hypothesize follows our evolutionary model of little steps.  We can convincingly argue that it isn&rsquo;t the length &ndash; we think of growth by percent increases &ndash; a mutation equally likely to increase or decrease the length by 1%, say, rather than by 1cm.  Logs do this for us.</p>

<p>Unfortunately it seems difficult to argue that residuals have this same natural interpretation, particularly when we would like to insist that both the traits and the residuals follow one of the common models (i.e. Brownian motion).</p>

<p>Assume the focal trait <em>X</em> and the body size <em>Y</em> are Brownian, in order to justify the Brownian-based phylogenetic Revell collection.  The residuals  <em>Z</em> are differences between these:</p>

<p>$$ dX<em>t = \sigma</em>{X} dB_{1} $$
$$ dY<em>t = \sigma</em>{Y} dB_{2} $$</p>

<p>The solutions to these are Gaussians, unfortunately the regression $$\beta$$ doesn&rsquo;t result in residuals that are also Gaussians,</p>

<p>$$ Z_t = X_t - \beta Y_t $$
$$ Z_t = N(\sigma_X) - \beta N(\sigma_Y) $$</p>

<p>which is not normally distributed (sums of normals aren&rsquo;t normals).  (Note that this differs from the standard regression in which there is only one source of noise, $ y ~ \beta x + \xi $).  The same is true for any of the common phylogenetic models, which are all multivariate normal distributions.</p>

<p>It seems impossible to do the phylogenetic correction of (Revell, 2009) consistently.  One could instead assert that the ratio of some size to body-size is, say, Brownian, without asserting that the individual traits are Brownian, and have a perhaps more consistent size correction.</p>

<h2 id="references">References</h2>

<ul>
<li><p>WAINWRIGHT P, BELLWOOD D, WESTNEAT M, GRUBICH J and HOEY A (2004).
&ldquo;A Functional Morphospace For The Skull of Labrid Fishes: Patterns of Diversity in A Complex Biomechanical System.&rdquo;
<em>Biological Journal of The Linnean Society</em>, <strong>82</strong>.
<a href="http://dx.doi.org/10.1111/j.1095-8312.2004.00313.x">http://dx.doi.org/10.1111/j.1095-8312.2004.00313.x</a>.</p></li>

<li><p>Price S, Wainwright P, Bellwood D, Kazancioglu E, Collar D and Near T (2010).
&ldquo;Functional Innovations And Morphological Diversification in Parrotfish.&rdquo;
<em>Evolution</em>.
<a href="http://dx.doi.org/10.1111/j.1558-5646.2010.01036.x">http://dx.doi.org/10.1111/j.1558-5646.2010.01036.x</a>.</p></li>

<li><p>Revell L (2009).
&ldquo;Size-Correction And Principal Components For Interspecific Comparative Studies.&rdquo;
<em>Evolution</em>, <strong>63</strong>.
ISSN 00143820, <a href="http://dx.doi.org/10.1111/j.1558-5646.2009.00804.x">http://dx.doi.org/10.1111/j.1558-5646.2009.00804.x</a>.</p></li>
</ul>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:http://ogp.me/ns/article#">
  
  
  
<div class="article-metadata">

  <p>
  <span class="article-date">
    <i class="fa fa-calendar"></i>
    
    <time datetime="2011-04-29 22:19:43 &#43;0000 UTC" itemprop="datePublished">
      Fri, Apr 29, 2011
    </time>
    
  </span>
  </p>
    

  <p>
  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="../../../../categories/evolution">evolution</a
    >
    
  </span>
  
  
  </p>
  
  <p>
  
  </p>

</div>

 
  <br />
  
  <p><a class="btn btn-default" rel="prev" href='../../../../2011/05/03/monday-3/'><i class="fa fa-chevron-left"></i> prev</a>
    <a class="btn btn-default" rel="next" href='../../../../2011/04/28/thursday-reading-notes/'>next <i class="fa fa-chevron-right"></i></a></p>

  <br />

  <p> <a class="btn btn-default" 
         href="https://github.com/cboettig/cboettig.github.io/commits/master/content/lab-notebook/2011-04-29-friday-notes-on-labrids-notes-on-transforms-and-size-corrections.md"><i class="fa fa-clock-o"></i> history</a></p>

  <p> <i class="fa fa-barcode"></i> SHA: <a href="https://github.com/cboettig/cboettig.github.io/blob/9d9072923c46d635718a4624d6afff6b1ec2439f/content/lab-notebook/2011-04-29-friday-notes-on-labrids-notes-on-transforms-and-size-corrections.md">9d9072923</a></p> 


</aside>

    </div>
  </div>
</div>


<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'cboettig';
    var disqus_identifier = '\/2011\/04\/29\/friday-notes-on-labrids-notes-on-transforms-and-size-corrections\/';
    var disqus_title = 'Friday: Notes on Labrids, notes on Transforms and size-corrections';
    var disqus_url = '\/2011\/04\/29\/friday-notes-on-labrids-notes-on-transforms-and-size-corrections\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>

<footer class="site-footer">
  <hr />
  <div class="container">

  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://carlboettiger.info/#me">
      <p>
      <script type="text/javascript" src="../../../../js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
           <a rel="foaf:weblog" type="application/atom+xml" href="../../../../index.xml"  
        class="showtooltip" title="RSS feeds for my blog-style entries." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    


    <div class="col-md-4 col-md-offset-1 col-xs-4">
	    <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="../../../../img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="../../../../img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>
</footer>


    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="../../../../js/jquery-1.12.3.min.js"></script>
    <script src="../../../../js/bootstrap.min.js"></script>
    <script src="../../../../js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="../../../../js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-18401403-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

 
