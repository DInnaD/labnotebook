<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.20.2" />
  <meta name="author" content="Carl Boettiger">
  

  
  
  
    
    
    <link rel="stylesheet" href="../../../../css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="../../../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../../css/font-awesome.min.css">
  <link rel="stylesheet" href="../../../../css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  
  
    <link rel="stylesheet" href="../../../../css/cboettig.css">
  
  
  <link rel="alternate" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">
  <link rel="feed" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">

  <link rel="icon" type="image/png" href="../../../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../../img/apple-touch-icon.png">
  <link rel="canonical" href="../../../../2011/11/01/training-problem-2-update/">


  <title>Training Problem 2 update | Boettiger Group</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../../">Boettiger Group</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="../../../../index.html">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../members/">
            
            <span>Members</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../vita/">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../teaching/">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../lab-notebook">
            
            <span>Lab Notebook</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    <h1>Training Problem 2 update</h1> 
      
    

<h2 id="problem-statement">Problem Statement</h2>

<p>We consider the stochastic optimal control problem of fisheries harvests under the scenarios involving alternate stable states, with uncertainty about the parameters of harvest. We consider a series of introductory problems to prepare us for the full problem. We begin with classical optimal control approaches (Pontraygin&rsquo;s principle to transform into an ordinary differential equation boundary-value problem) for continuous time state equations (fish population dynamics) as a reference point. We begin with a one-dimensional state equation. We next consider the discrete-time state equation, which we approach with the Bellman/dynamic programming solution, as a useful starting point for the stochastic control. The continuous-time problem can solved from the Hamilton-Jacobi-Bellman PDE, instead of the BVP. While this is less efficient numerically, it generalizes to the stochastic case most naturally. The stochastic solution for the optimal path still assumes perfect knowledge. We can accommodate uncertainty in the state variables in a Bayesian learning framework.</p>

<p>So far I (Carl) am about half-way through these toy examples which will help set up the training problem.  Once we have a common set of tools and code we have quite a few questions to explore within the uncertainty problem.</p>

<p>(See <a href="http://www.carlboettiger.info/archives/2655">original</a> task description)</p>

<h2 id="introductory-problem-by-pontryagin-minimization">Introductory Problem by Pontryagin minimization</h2>

<p>Optimal control with an allee effect. Continuous time, Pontraygin&rsquo;s minimum principle for the first-order conditions to establish a boundary value problem.</p>

<ul>
<li><p><a href="http://www.carlboettiger.info/archives/3001">BVP derivation</a></p></li>

<li><p><a href="http://www.carlboettiger.info/archives/3049">Numerical solutions</a> in several cases</p></li>

<li><p><a href="https://github.com/cboettig/pdg_control/">Code</a> for numerics</p></li>
</ul>

<h2 id="discrete-problem-by-bellman-equation-dynamic-programming">Discrete problem by Bellman equation, Dynamic Programming</h2>

<p>Optimal control for the analogous discrete time state equations.  Provides a dynamic programming example solution, introduces the cost-to-go.</p>

<ul>
<li><p>Problem setup <a href="http://www.carlboettiger.info/archives/3076">notes</a>.</p></li>

<li><p>Code</p></li>
</ul>

<h2 id="continuous-problem-by-hamilton-jacobi-bellman-pde">Continuous problem by Hamilton-Jacobi-Bellman PDE</h2>

<p>As in the introductory problem. Discritize $ dt $,   and then by Taylor expansion the recursion of the cost to go becomes the HJB PDE:</p>

<p>$$ \partial_t J(x,t) = \min_h \left( U(x,h,t)  +  \beta f(x,h,t) \partial_x J(x,t)   \right) $$</p>

<p>and the optimal path obeys:</p>

<p>$$ h(x,t) = \arg \min_h \left( U(x,h,t) + \beta \partial_x J(x,t) f(x,h, t) \right) $$</p>

<h2 id="stochastic-problem">Stochastic problem</h2>

<p>State equation is an SDE ((perhaps restricted to $g(x,h,t) = 1$? ))
$$ dx =f(x(t), h(t), t)dt + g(x(t), h(t), t) dB_t $$</p>

<p>and we minimize the expected cost.</p>

<p>$$ \max_h \left( \phi( \langle x(T) \rangle ) + \left \langle \int_0^T e^{-\rho t} \pi(x,h,t) dt \right \rangle \right)$$</p>

<p>For a Gaussian process we solve the stochastic HJB (from taking expectations over the path gives a deterministic PDE by that name):</p>

<p>$$ \partial_t J(x,t) = \min_h \left( U(x,h,t)  +  \beta f(x,h,t) \partial_x J(x,t)   + \frac{1}{2} \nu(x,h,t) \partial_x^2 J(x,t) \right)  $$</p>

<p>Where $ \nu(x,h,t ) $ is the variance dynamics for the state equation.  This may require a numerical solution for appropriate definitions of the stochastic state model, e.g.</p>

<p>$ d X = \alpha X \left(1-\frac{X}{K}\right) \left( \frac{X-C}{K} \right) - X h + \sigma X dB $</p>

<p>Not as bad as it appears perhaps; for instance, <a href="http://en.wikipedia.org/wiki/Merton%27s_portfolio_problem">Merton&rsquo;s portfolio problem</a> is actually an example of this nature with a closed-form solution. There are efficient numerical solutions for linear-quadratic control versions, perhaps of little use to us.</p>

<h2 id="stochastic-problem-with-uncertainty">Stochastic problem with uncertainty</h2>

<p>(Finite time-horizon). Either the parameters of the cost function or the state equation are unknown, and we update our belief about the parameters according to Bayes rule:
$$p_{t+dt} (\alpha | dx, h) \propto p(dx | \alpha, h) p_t(\alpha) $$</p>

<p>We define sufficient statistics for this distribution, and have a control problem with an extra dimension in the state equations. The expected profit is computed over both dimensions:
$$ \max_h \left \langle \phi( x(T) ) + \int<em>0^T e^{-\rho t} \pi(x,h,t) dt \right \rangle</em>{\theta, x} $$</p>

<h2 id="higher-dimensional-dynamics">Higher dimensional dynamics</h2>

<p>Each of these problems can then be repeated with the proper 3-dimensional parrotfish system:</p>

<p>$$ \frac{dM}{dt} = a MC - \frac{g(P) M}{M+T}+\gamma MT $$</p>

<p>$$ \frac{dC}{dt} = (rT - d-aM)C $$</p>

<p>$$ \frac{dP}{dt} = sP\left( 1-\frac{P}{K&copy;}\right) - fP$$</p>

<p>K&copy; is from territorial limits, rather than food limits.  (Blackwood <em>et. al.</em> 2010)</p>

<p>Adding habitat quality (Blackwood <em>et. al.</em> 2011).</p>

<h2 id="references">References</h2>

<ul>
<li><p>Blackwood J, Hastings A and Mumby P (2010).
&ldquo;The Effect of Fishing on Hysteresis in Caribbean Coral Reefs.&rdquo;
<em>Theoretical Ecology</em>, <strong>5</strong>.
ISSN 1874-1738, <a href="http://dx.doi.org/10.1007/s12080-010-0102-0">http://dx.doi.org/10.1007/s12080-010-0102-0</a>.</p></li>

<li><p>Blackwood J, Hastings A and Mumby P (2011).
&ldquo;A Model-Based Approach to Determine The Long-Term Effects of Multiple Interacting Stressors on Coral Reefs.&rdquo;
<em>Ecological Applications</em>, <strong>21</strong>.
ISSN 1051-0761, <a href="http://dx.doi.org/10.1890/10-2195.1">http://dx.doi.org/10.1890/10-2195.1</a>.</p></li>
</ul>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:http://ogp.me/ns/article#">
  
  
  
<div class="article-metadata">

  <p>
  <span class="article-date">
    <i class="fa fa-calendar"></i>
    
    <time datetime="2011-11-01 14:20:08 &#43;0000 UTC" itemprop="datePublished">
      Tue, Nov 1, 2011
    </time>
    
  </span>
  </p>
    

  <p>
  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="../../../../categories/ecology">ecology</a
    >
    
  </span>
  
  
  </p>
  
  <p>
  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="../../../../tags/pdg-control">pdg-control</a
    >
    
  </span>
  
  
  </p>

</div>

 
  <br />
  
  <p><a class="btn btn-default" rel="prev" href='../../../../2011/11/01/pdg-control-conference-call/'><i class="fa fa-chevron-left"></i> prev</a>
    <a class="btn btn-default" rel="next" href='../../../../2011/11/01/labrids-parrotfish-method1/'>next <i class="fa fa-chevron-right"></i></a></p>

  <br />

  <p> <a class="btn btn-default" 
         href="https://github.com/cboettig/cboettig.github.io/commits/master/content/lab-notebook/2011-11-01-training-problem-2-update.md"><i class="fa fa-clock-o"></i> history</a></p>

  <p> <i class="fa fa-barcode"></i> SHA: <a href="https://github.com/cboettig/cboettig.github.io/blob/21c35f18f26809fba50d510222998c5f9963fff4/content/lab-notebook/2011-11-01-training-problem-2-update.md">21c35f1</a></p> 


</aside>

    </div>
  </div>
</div>


<section id="comments">
  <div id="disqus_thread">
    
  </div>
</section>

<footer class="site-footer">
  <hr />
  <div class="container">

  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://carlboettiger.info/#me">
      <p>
      <script type="text/javascript" src="../../../../js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
           <a rel="foaf:weblog" type="application/atom+xml" href="../../../../index.xml"  
        class="showtooltip" title="RSS feeds for my blog-style entries." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    


    <div class="col-md-4 col-md-offset-1 col-xs-4">
	    <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="../../../../img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="../../../../img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>
</footer>


    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="../../../../js/jquery-1.12.3.min.js"></script>
    <script src="../../../../js/bootstrap.min.js"></script>
    <script src="../../../../js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="../../../../js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-18401403-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

 
