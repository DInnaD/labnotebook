<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.20.2" />
  <meta name="author" content="Carl Boettiger">
  

  
  
  
    
    
    <link rel="stylesheet" href="../../../../css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="../../../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../../css/font-awesome.min.css">
  <link rel="stylesheet" href="../../../../css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  
  
    <link rel="stylesheet" href="../../../../css/cboettig.css">
  
  
  <link rel="alternate" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">
  <link rel="feed" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">

  <link rel="icon" type="image/png" href="../../../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../../img/apple-touch-icon.png">
  <link rel="canonical" href="../../../../2011/07/20/showcasing-the-latest-phylogenetic-methods-auteur/">


  <title>Showcasing the latest phylogenetic methods: AUTEUR | Boettiger Group</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../../">Boettiger Group</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="../../../../index.html">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../members/">
            
            <span>Members</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../vita/">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../teaching/">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../lab-notebook">
            
            <span>Lab Notebook</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    <h1>Showcasing the latest phylogenetic methods: AUTEUR</h1> 
      
    <p>While high-speed fish feeding videos may be the signature of the lab, dig a bit deeper and you&rsquo;ll find a wealth of comparative phylogenetic methods sneaking in.  It&rsquo;s a natural union &ndash; expert functional morphology is the key to good comparative methods, just as phylogenies hold the key to untangling the evolutionary origins of that morphology.  The lab&rsquo;s own former graduate, <a href="http://www.brianomeara.info/">Brian O&rsquo;Meara</a>, made a revolutionary step forward in the land of phylogenetic methods when he unveiled <em>Brownie</em> in 2006, allowing researchers to identify major shifts in trait diversification rates across the tree.  This work spurred not only a flood of empirical applications but also methodological innovations, such as Liam&rsquo;s <a href="http://phytools.blogspot.com/2011/07/more-robust-version-of-brownielite.html">brownie-lite</a>, and today&rsquo;s focus: <a href="http://public.wsu.edu/~storfer/eastman/pages/index.html">Jon Eastman</a> <em>et al.</em>&rsquo;s auteur package.</p>

<p>Auteur, short for &ldquo;Accommodating uncertainty in trait evolution using R,&rdquo; is the grown-up Bayesian RJMCMC version of that original idea in <em>Brownie</em>.  Diversification rates can change along the phylogenetic tree &ndash; only this time, you don&rsquo;t have to specify where those changes could have occurred, or how many there may have been &ndash; auteur simply tries them all.</p>

<p>If you want the details, definitely go <a href="http://doi.wiley.com/10.1111/j.1558-5646.2011.01401.x">read the paper</a> &ndash; it&rsquo;s all there, clear and thorough.  Meanwhile, what we really want to do, is take it out for a test drive.</p>

<p>The package isn&rsquo;t up on CRAN yet, so you can grab the development version from Jon&rsquo;s <a href="https://github.com/eastman/auteur">github</a> page, or <a href="https://github.com/downloads/eastman/auteur/auteur_0.11.0612.tar.gz">click here</a>.  Put that package in a working directory and fire up R in that directory.  Let&rsquo;s go for a spin.</p>

<pre><code class="language-R">
install.packages(&quot;auteur_0.11.0612.tar.gz&quot;, repos=NULL)
library(auteur)


</code></pre>

<p>Great, the package installed and loaded successfully. Looks like Jon&rsquo;s put all 73 functions into the NAMESPACE, but it&rsquo;s not hard to guess which one looks like the right one to start with.  rjmcmc.bm.  Yeah, that looks good.  It has a nice help file, with &ndash; praise the fish &ndash; example code.  Looks like we&rsquo;re gonna run a simulation, where we know the answer, and see how it does:</p>

<pre><code class="language-R">

     #############
     ## generate tree
     n=24
     while(1) {
             phy=prunelastsplit(birthdeath.tree(b=1,d=0,taxa.stop=n+1))
             phy$tip.label=paste(&quot;sp&quot;,1:n,sep=&quot;&quot;)
             rphy=reorder(phy,&quot;pruningwise&quot;)

             # find an internal edge
             anc=get.desc.of.node(Ntip(phy)+1,phy)
             branches=phy$edge[,2]
             branches=branches[branches&gt;Ntip(phy) &amp; branches!=anc]
             branch=branches[sample(1:length(branches),1)]
             desc=get.descendants.of.node(branch,phy)
             if(length(desc)&gt;=4) break()
     }
     rphy=phy
     rphy$edge.length[match(desc,phy$edge[,2])]=phy$edge.length[match(desc,phy$edge[,2])]*64

     e=numeric(nrow(phy$edge))
     e[match(c(branch,desc),phy$edge[,2])]=1
     cols=c(&quot;red&quot;,&quot;gray&quot;)
     dev.new()
     plot(phy,edge.col=ifelse(e==1,cols[1],cols[2]), edge.width=2)
     mtext(&quot;expected pattern of rates&quot;)

     #############
     ## simulate data on the 'rate-shifted' tree
     dat=rTraitCont(phy=rphy, model=&quot;BM&quot;, sigma=sqrt(0.1))


</code></pre>

<p>That creates this beautiful example (sorry, no random generator seed, you&rsquo;re results may vary but that&rsquo;s ok) tree:</p>

<p><img src="http://farm7.static.flickr.com/6123/5952070152_e7761d597c.jpg" alt="" />
Okay, so that&rsquo;s the target, showing where the shift occurred.  Note the last line got us some data on this tree.  We&rsquo;re ready to run the software.  It looks super easy:</p>

<pre><code class="language-R">
## run two short reversible-jump Markov chains
 r=paste(sample(letters,9,replace=TRUE),collapse=&quot;&quot;)
 lapply(1:2, function(x) rjmcmc.bm(phy=phy, dat=dat, ngen=10000, sample.freq=10, prob.mergesplit=0.1, simplestart=TRUE, prop.width=1, fileBase=paste(r,x,sep=&quot;.&quot;)))

</code></pre>

<p>The data is going in as &ldquo;phy&rdquo; and &ldquo;dat&rdquo;, just as expected.  We won&rsquo;t worry about the optional parameters that follow for the moment.  Note that because we use lapply to run multiple chains, it would be super easy to run this on multiple processors.</p>

<p>Note that Jon&rsquo;s creating a bunch of directories to store parameters, etc.  This can be important for MCMC methods where chains get too cumbersome to handle in memory.  Enough technical rambling, let&rsquo;s merge and load those files in now, and plot what we got:</p>

<pre><code class="language-R">
# collect directories
dirs=dir(&quot;./&quot;,pattern=paste(&quot;BM&quot;,r,sep=&quot;.&quot;))
pool.rjmcmcsamples(base.dirs=dirs, lab=r)

## view contents of .rda
load(paste(paste(r,&quot;combined.rjmcmc&quot;,sep=&quot;.&quot;),paste(r,&quot;posteriorsamples.rda&quot;,sep=&quot;.&quot;),sep=&quot;/&quot;))
print(head(posteriorsamples$rates))
print(head(posteriorsamples$rate.shifts))

## plot Markov sampled rates
dev.new()
shifts.plot(phy=phy, base.dir=paste(r,&quot;combined.rjmcmc&quot;,sep=&quot;.&quot;), burnin=0.5, legend=TRUE, edge.width=2)

# clean-up: unlink those directories
 unlink(dir(pattern=paste(r)),recursive=TRUE)

</code></pre>

<p><img src="http://farm7.static.flickr.com/6001/5952112488_91867e7f3a.jpg" alt="" /></p>

<p>Not only is that a beautiful plot, but it&rsquo;s nailed the shift in species 12-16.  How&rsquo;d your example do?</p>

<p>Auteur comes with three beautiful large data sets described in the paper.  Check them out, but expect longer run times than our simple example!</p>

<pre><code class="language-R">

data(chelonia)
# take a look at this data
&gt; chelonia
$phy
Phylogenetic tree with 226 tips and 225 internal nodes.

Tip labels:
Elseya_latisternum, Chelodina_longicollis, Phrynops_gibbus, Acanthochelys_radiolata, Acanthochelys_macrocephala, Acanthochelys_pallidipectoris, ...

Rooted; includes branch lengths.

$dat
Pelomedusa_subrufa                   Pelusios_williamsi
2.995732                             3.218876
...
dat &lt;- chelonia$dat
phy &lt;- chelonia$phy
## ready to run as above


</code></pre>

<p><a href="http://www.R-bloggers.com"><img src="http://a1.twimg.com/profile_images/1344218056/RblogLogo_bigger.png" alt="R-bloggers.com" /></a></p>

<p>Thanks Jon and the rest of the Harmon Lab for a fantastic package. This is really just a tip of the iceberg, but should help get you started. See the paper for a good example of posterior analyses requisite after running any kind of MCMC, or stay tuned for a later post.</p>

<p>(cross-posted from <a href="http://fishlab.ucdavis.edu/?p=303">my entry on the Wainwright lab blog</a>.)</p>

<p><a href="http://www.researchblogging.org"><img src="http://www.researchblogging.org/public/citation_icons/rb2_large_gray.png" alt="ResearchBlogging.org" /></a>
Eastman, J., Alfaro, M., Joyce, P., Hipp, A., &amp; Harmon, L. (2011). A NOVEL COMPARATIVE METHOD FOR IDENTIFYING SHIFTS IN THE RATE OF CHARACTER EVOLUTION ON TREES Evolution DOI: <a href="http://dx.doi.org/10.1111/j.1558-5646.2011.01401.x">10.1111/j.1558-5646.2011.01401.x</a></p>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:http://ogp.me/ns/article#">
  
  
  
<div class="article-metadata">

  <p>
  <span class="article-date">
    <i class="fa fa-calendar"></i>
    
    <time datetime="2011-07-20 15:07:14 &#43;0000 UTC" itemprop="datePublished">
      Wed, Jul 20, 2011
    </time>
    
  </span>
  </p>
    

  <p>
  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="../../../../categories/evolution">evolution</a
    >
    
  </span>
  
  
  </p>
  
  <p>
  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="../../../../tags/r">R</a
    >, 
    
    <a href="../../../../tags/research-blogging">research-blogging</a
    >
    
  </span>
  
  
  </p>

</div>

 
  <br />
  
  <p><a class="btn btn-default" rel="prev" href='../../../../2011/07/24/csgf-2010-hpc-practices-survey-summary/'><i class="fa fa-chevron-left"></i> prev</a>
    <a class="btn btn-default" rel="next" href='../../../../2011/07/17/sunday-warning-signals/'>next <i class="fa fa-chevron-right"></i></a></p>

  <br />

  <p> <a class="btn btn-default" 
         href="https://github.com/cboettig/cboettig.github.io/commits/master/content/lab-notebook/2011-07-20-showcasing-the-latest-phylogenetic-methods-auteur.md"><i class="fa fa-clock-o"></i> history</a></p>

  <p> <i class="fa fa-barcode"></i> SHA: <a href="https://github.com/cboettig/cboettig.github.io/blob/21c35f18f26809fba50d510222998c5f9963fff4/content/lab-notebook/2011-07-20-showcasing-the-latest-phylogenetic-methods-auteur.md">21c35f1</a></p> 


</aside>

    </div>
  </div>
</div>


<section id="comments">
  <div id="disqus_thread">
    
  </div>
</section>

<footer class="site-footer">
  <hr />
  <div class="container">

  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://carlboettiger.info/#me">
      <p>
      <script type="text/javascript" src="../../../../js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
           <a rel="foaf:weblog" type="application/atom+xml" href="../../../../index.xml"  
        class="showtooltip" title="RSS feeds for my blog-style entries." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    


    <div class="col-md-4 col-md-offset-1 col-xs-4">
	    <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="../../../../img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="../../../../img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>
</footer>


    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="../../../../js/jquery-1.12.3.min.js"></script>
    <script src="../../../../js/bootstrap.min.js"></script>
    <script src="../../../../js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="../../../../js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-18401403-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

 
