<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.20.2" />
  <meta name="author" content="Carl Boettiger">
  

  
  
  
    
    
    <link rel="stylesheet" href="../../../../css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="../../../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../../css/font-awesome.min.css">
  <link rel="stylesheet" href="../../../../css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  
  
    <link rel="stylesheet" href="../../../../css/cboettig.css">
  
  
  <link rel="alternate" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">
  <link rel="feed" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">

  <link rel="icon" type="image/png" href="../../../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../../img/apple-touch-icon.png">
  <link rel="canonical" href="../../../../2011/10/28/optimal-control-examples-continued-bellman-dynamic-programming/">


  <title>Optimal Control examples continued: Bellman,  Dynamic Programming | Boettiger Group</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../../">Boettiger Group</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="../../../../index.html">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../members/">
            
            <span>Members</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../vita/">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../teaching/">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../lab-notebook">
            
            <span>Lab Notebook</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    <h1>Optimal Control examples continued: Bellman,  Dynamic Programming</h1> 
      
    

<h3 id="discrete-time-state-equation">Discrete-time state equation</h3>

<p>Discrete-time solution appears to be all about <strong>dynamic programming</strong></p>

<p>and a chance for me to remember that I&rsquo;m out of practice writing recursive functions. It&rsquo;s just that in thinking about the problem, you start from the end, with the trivial subcase, and keep adding the layers. But the recursive function kinda starts at the beginning, and that trivial case is the exit condition. R doesn&rsquo;t seem very efficient with these recursive functions, so this might become a C sub-routine eventually.</p>

<h4 id="problem-setup">Problem setup</h4>

<p>We consider some discrete-time state equation for (fish stock, $x$) under some control parameter (harvest, $h$):</p>

<p>$$ x_{t+1} = f(x_t, h) $$</p>

<p>We again have utility function, $\pi(h)$ for diminishing returns on fish harvest. Discrete time means we maximize over the discrete discounting rate $\beta$ and sum over intervals:</p>

<p>$$ \max_{h<em>t} \sum</em>{t=0}^T \beta^t \pi(h) $$</p>

<p>subject to the state equation above and some boundary conditions $x_0 = X_0, \qquad x_T = X_T$.  First-order conditions are:</p>

<p>$$ U&rsquo;(h<em>t) = \beta U&rsquo;(h</em>{t+1}) F&rsquo;(x_{t+1} ) \forall t $$
and solution will use a dynamic programming approach of the following recursion</p>

<p>$$ V(x_t) = \max<em>h \left( U(h) + \beta V(x</em>{t+1} ) \right) $$</p>

<p>Which substituting in the state equation gives us:</p>

<p>$$ V(x_t) = \max_h \left( U(h) + \beta V( F(x<em>t)) \right) $$
Let&rsquo;s assume a discrete Ricker-style model:
$$ x</em>{t+1} = f(x,h) = x \exp \left( \alpha \left(1-\frac{x}{K}\right) \left( \frac{x-C}{K} \right) \right) - h x $$</p>

<p>The Ricker-style formulation in analogy to our continuous time <a href="http://www.carlboettiger.info/archives/3001">problem</a>, Alan suggests we actually consider the case by Myers et al., (Myers <em>et. al.</em> 1995)</p>

<p>$$N_{t+1} = \frac{r N_t^{\alpha}}{1+\frac{N_t^{\alpha}}{K} } $$</p>

<p>Trivial case of no cost at boundary, harvests everything.<br />
<img src="http://farm7.staticflickr.com/6046/6303190675_b1151d0931_o.png" alt="" /></p>

<h3 id="a-simpler-case">A simpler case</h3>

<p>Fish remaining are whatever wasn&rsquo;t harvested yet:
$$ x_{t+1} = x_t - h_t $$</p>

<p>Cost/profit of harvesting: Profit $p(t)$ per fish (possibly varies with year), but cost gets harder $c h^2$, $c &lt;&lt; p(t)$,
$$ U(h) = p h - c h^2 $$</p>

<p>The algorithm can be specified by recursion,</p>

<pre><code class="language-R">
phi &lt;- function(x) 300

J &lt;- function(t,x){
  if(t &lt; T)
    out &lt;- U(t,x, h_star(t,x)) + beta*J(t+1, f(t,x, h_star(t,x)))
  else 
    out &lt;- phi(x)
  out
}
 
h_star &lt;- function(t,x){
    func &lt;- function(h) U(t, x, h) + beta*J(t+1, f(t,x,h))
#    optimize(f=func, interval=c(0,1))[[1]]
    h &lt;- seq(0,1000,length=500)
    cost &lt;- sapply(h, func)
    i &lt;- which.max(cost)
    h[i]
}

</code></pre>

<p>See <a href="https://github.com/cboettig/pdg_control/blob/2fedf60ae61dafb21badaf05f1a97c213d59b1d1/R/discrete_optimal_control.R">full code</a>.</p>

<p><img src="http://farm7.staticflickr.com/6043/6306213989_bf88df311d_o.png" alt="" /></p>

<p>but this is terribly inefficient.</p>

<p>A simple dynamic programming reference <a href="http://frank.mtsu.edu/~berc/working/Zietz-DP-1.pdf">here</a>.</p>

<h3 id="stochastic-optimal-control">Stochastic Optimal Control</h3>

<p>Looks like this needs a dynamic programming approach.  A us<a href="http://userpage.fu-berlin.de/~mtoussai/08-optimal-control/kappen-handout.pdf">eful reference. </a></p>

<h3 id="higher-dimensional-state-equations">Higher-dimensional state equations</h3>

<p>Can these lead to oscillating solutions in as the number of state equations increases? Depends on nature of constraints? Inequalities?</p>

<h3 id="steps-check-list">Steps check list</h3>

<ol>
<li><p>Simple boundary-value problem solution by collocation. <a href="http://www.carlboettiger.info/archives/3001">Example</a>.</p></li>

<li><p>Chebychev polynomial collocation</p></li>

<li><p>Harvest vs fishing effort as control variable.</p></li>

<li><p>Solution under inequality bounds</p></li>

<li><p>Discrete-time state equations</p></li>

<li><p>Stochastic Control</p></li>

<li><p>Parrotfish 3 dimensional system, Horan 2 dimensional system. Â See (Mumby <em>et. al.</em> 2007), (Blackwood <em>et. al.</em> 2010) (Horan <em>et. al.</em> 2011)</p></li>

<li><p>Uncertainty</p></li>
</ol>

<h2 id="references">References</h2>

<ul>
<li><p>Myers R, Barrowman N, Hutchings J and Rosenberg A (1995).
&ldquo;Population Dynamics of Exploited Fish Stocks at Low Population Levels.&rdquo;
<em>Science</em>, <strong>269</strong>.
ISSN 0036-8075, <a href="http://dx.doi.org/10.1126/science.269.5227.1106">http://dx.doi.org/10.1126/science.269.5227.1106</a>.</p></li>

<li><p>Mumby P, Hastings A and Edwards H (2007).
&ldquo;Thresholds And The Resilience of Caribbean Coral Reefs.&rdquo;
<em>Nature</em>, <strong>450</strong>.
ISSN 0028-0836, <a href="http://dx.doi.org/10.1038/nature06252">http://dx.doi.org/10.1038/nature06252</a>.</p></li>

<li><p>Blackwood J, Hastings A and Mumby P (2010).
&ldquo;The Effect of Fishing on Hysteresis in Caribbean Coral Reefs.&rdquo;
<em>Theoretical Ecology</em>, <strong>5</strong>.
ISSN 1874-1738, <a href="http://dx.doi.org/10.1007/s12080-010-0102-0">http://dx.doi.org/10.1007/s12080-010-0102-0</a>.</p></li>

<li><p>Horan R, Fenichel E, Drury K and Lodge D (2011).
&ldquo;Managing Ecological Thresholds in Coupled Environmental-Human Systems.&rdquo;
<em>Proceedings of The National Academy of Sciences</em>, <strong>108</strong>.
ISSN 0027-8424, <a href="http://dx.doi.org/10.1073/pnas.1005431108">http://dx.doi.org/10.1073/pnas.1005431108</a>.</p></li>
</ul>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:http://ogp.me/ns/article#">
  
  
  
<div class="article-metadata">

  <p>
  <span class="article-date">
    <i class="fa fa-calendar"></i>
    
    <time datetime="2011-10-28 23:23:12 &#43;0000 UTC" itemprop="datePublished">
      Fri, Oct 28, 2011
    </time>
    
  </span>
  </p>
    

  <p>
  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="../../../../categories/ecology">ecology</a
    >
    
  </span>
  
  
  </p>
  
  <p>
  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="../../../../tags/pdg-control">pdg-control</a
    >, 
    
    <a href="../../../../tags/warning-signals">warning-signals</a
    >
    
  </span>
  
  
  </p>

</div>

 
  <br />
  
  <p><a class="btn btn-default" rel="prev" href='../../../../2011/10/31/monday-openfisheries-ggplot/'><i class="fa fa-chevron-left"></i> prev</a>
    <a class="btn btn-default" rel="next" href='../../../../2011/10/27/optimal-control-next-steps/'>next <i class="fa fa-chevron-right"></i></a></p>

  <br />

  <p> <a class="btn btn-default" 
         href="https://github.com/cboettig/cboettig.github.io/commits/master/content/lab-notebook/2011-10-28-optimal-control-examples-continued-bellman-dynamic-programming.md"><i class="fa fa-clock-o"></i> history</a></p>

  <p> <i class="fa fa-barcode"></i> SHA: <a href="https://github.com/cboettig/cboettig.github.io/blob/21c35f18f26809fba50d510222998c5f9963fff4/content/lab-notebook/2011-10-28-optimal-control-examples-continued-bellman-dynamic-programming.md">21c35f1</a></p> 


</aside>

    </div>
  </div>
</div>


<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'cboettig';
    var disqus_identifier = '\/2011\/10\/28\/optimal-control-examples-continued-bellman-dynamic-programming\/';
    var disqus_title = 'Optimal Control examples continued: Bellman,  Dynamic Programming';
    var disqus_url = '\/2011\/10\/28\/optimal-control-examples-continued-bellman-dynamic-programming\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>

<footer class="site-footer">
  <hr />
  <div class="container">

  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://carlboettiger.info/#me">
      <p>
      <script type="text/javascript" src="../../../../js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
           <a rel="foaf:weblog" type="application/atom+xml" href="../../../../index.xml"  
        class="showtooltip" title="RSS feeds for my blog-style entries." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    


    <div class="col-md-4 col-md-offset-1 col-xs-4">
	    <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="../../../../img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="../../../../img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>
</footer>


    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="../../../../js/jquery-1.12.3.min.js"></script>
    <script src="../../../../js/bootstrap.min.js"></script>
    <script src="../../../../js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="../../../../js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-18401403-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

 
