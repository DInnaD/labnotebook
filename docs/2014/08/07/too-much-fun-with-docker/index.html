<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.20.2" />
  <meta name="author" content="Carl Boettiger">
  

  
  
  
    
    
    <link rel="stylesheet" href="../../../../css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="../../../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../../css/font-awesome.min.css">
  <link rel="stylesheet" href="../../../../css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  
  
    <link rel="stylesheet" href="../../../../css/cboettig.css">
  
  
  <link rel="alternate" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">
  <link rel="feed" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">

  <link rel="icon" type="image/png" href="../../../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../../img/apple-touch-icon.png">
  <link rel="canonical" href="../../../../2014/08/07/too-much-fun-with-docker/">


  <title> | Boettiger Group</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../../">Boettiger Group</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="../../../../index.html">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../members/">
            
            <span>Members</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../vita/">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../teaching/">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../lab-notebook">
            
            <span>Lab Notebook</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    
      
    

<p><strong>NOTE:</strong> This post was originally drafted as a set of questions to the revived <a href="https://groups.google.com/forum/#!forum/ropensci-discuss">ropensci-discuss list</a>, hopefully readers might join the discussion from there.</p>

<p>Been thinking about Docker and the discussion about reproducible research in the comments of Rich et al&rsquo;s recent post on the <a href="ropensci.org/blog/2014/06/09/reproducibility/">rOpenSci blog</a> where quite a few of people mentioned the potential for Docker as a way to facilitate this.</p>

<p>I&rsquo;ve only just started playing around with Docker, and though I&rsquo;m quite impressed, I&rsquo;m still rather skeptical that non-crazies would ever use it productively.  Nevertheless, I&rsquo;ve worked up some Dockerfiles to explore how one might use this approach to transparently document and manage a computational environment, and I was hoping to get some feedback from all of you.</p>

<p>For those of you who are already much more familiar with Docker than me (or are looking for an excuse to explore!), I&rsquo;d love to get your feedback on some of the particulars.  For everyone, I&rsquo;d be curious what you think about the general concept.</p>

<p>So far I&rsquo;ve created a <a href="https://github.com/ropensci/docker-ubuntu-r/blob/master/add-r-ropensci/Dockerfile">dockerfile</a> and <a href="https://registry.hub.docker.com/u/cboettig/ropensci-docker/">image</a></p>

<p>If you have docker up and running, perhaps you can give it a test drive:</p>

<pre><code>docker run -it cboettig/ropensci-docker /bin/bash
</code></pre>

<p>You should find R installed with some common packages.  This image builds on Dirk Eddelbuettel&rsquo;s R docker images and serves as a starting point to test individual R packages or projects.</p>

<p>For instance, my RNeXML manuscript draft is a bit more of a bear then usual to run, since it needs <code>rJava</code> (requires external libs), <code>Sxslt</code> (only available on Omegahat and requires extra libs) and latest <code>phytools</code> (a tar.gz file from Liam&rsquo;s website), along with the usual mess of pandoc/latex environment to compile the manuscript itself.  By building on ropensci-docker, we need a <a href="https://github.com/ropensci/RNeXML/tree/master/manuscripts/Dockerfile">pretty minimal docker file</a> to compile this environment:</p>

<p>You can test drive it (<a href="https://registry.hub.docker.com/u/cboettig/rnexml">docker image here</a>):</p>

<pre><code>docker run -it cboettig/rnexml /bin/bash
</code></pre>

<p>Once in bash, launch R and run <code>rmarkdown::render(&quot;manuscript.Rmd&quot;)</code>.  This will recompile the manuscript from cache and leave you to interactively explore any of the R code shown.</p>

<h2 id="advantages-goals">Advantages / Goals</h2>

<p>Being able to download a pre-compiled image means a user can run the code without dependency hell (often not as much an R problem as it is in Python, but nevertheless one that I hit frequently, particularly as my projects age), and also without altering their personal R environment. Third (in principle) this makes it easy to run the code on a cloud server, scaling the computing resources appropriately.</p>

<p>I think the real acid test for this is not merely that it recreates the results, but that others can build and extend on the work (with fewer rather than more barriers than usual). I believe most of that has nothing to do with this whole software image thing &ndash; providing the methods you use as general-purpose functions in an R package, or publishing the raw (&amp; processed) data to Dryad with good documentation will always make work more modular and easier to re-use than cracking open someone&rsquo;s virtual machine.  But that is really a separate issue.</p>

<p>In this context, we look for an easy way to package up whatever a researcher or group is already doing into something portable and extensible.  So, is this really portable and extensible?</p>

<h2 id="concerns">Concerns:</h2>

<ol>
<li><p>This presupposes someone can run docker on their OS &ndash; and from the command line at that.  Perhaps that&rsquo;s the biggest barrier to entry right now, (though given docker&rsquo;s virulent popularity, maybe something smart people with big money might soon solve).</p></li>

<li><p>The only way to interact with thing is through a bash shell running on the container.  An RStudio server might be much nicer, but I haven&rsquo;t been able to get that running.  <em>Anyone know how to run RStudio server from docker?</em></p></li>
</ol>

<p>(I tried &amp; <a href="https://github.com/mingfang/docker-druid/issues/2">failed</a>)</p>

<ol>
<li>I don&rsquo;t see how users can move local files on and off the docker container.  In some ways this is a great virtue &ndash; forcing all code to use fully resolved paths like pulling data from Dryad instead of their hard-drive, and pushing results to a (possibly private) online site to view them.  But obviously a barrier to entry.  <em>Is there a better way to do this?</em></li>
</ol>

<h2 id="alternative-strategies">Alternative strategies</h2>

<p>1) Docker is just one of many ways to do this (particularly if you&rsquo;re not concerned about maximum performance speed), and quite probably not the easiest. Our friends at Berkeley D-Lab opted for a GUI-driven virtual machine instead, built with Packer and run in Virtualbox, after their experience proved that students were much more comfortable with the mouse-driven installation and a pixel-identical environment to the instructor&rsquo;s (see their excellent <a href="https://berkeley.app.box.com/s/w424gdjot3tgksidyyfl">paper</a> on this).</p>

<p>2) Will/should researchers be willing to work and develop in virtual environments?  In some cases, the virtual environment can be closely coupled to the native one &ndash; you use your own editors etc to do all the writing, and then execute in the virtual environment (seems this is easier in docker/vagrant approach than in the BCE.</p>

<!--

I would like a way for a collaborator who knows a little R to be able to open my .Rmd manuscript on his/her own computer, edit some parameters, recompile and view the pdf. RStudio w/ rmarkdown has gone a long way to making that happen.
-->

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:http://ogp.me/ns/article#">
  
  
  
<div class="article-metadata">

  <p>
  <span class="article-date">
    <i class="fa fa-calendar"></i>
    
    <time datetime="2014-08-07 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Thu, Aug 7, 2014
    </time>
    
  </span>
  </p>
    

  <p>
  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="../../../../categories/open-science">open-science</a
    >
    
  </span>
  
  
  </p>
  
  <p>
  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="../../../../tags/blog">blog</a
    >
    
  </span>
  
  
  </p>

</div>

 
  <br />
  
  <p><a class="btn btn-default" rel="prev" href='../../../../2014/08/08/an-appropriate-amount-of-fun-with-docker/'><i class="fa fa-chevron-left"></i> prev</a>
    <a class="btn btn-default" rel="next" href='../../../../2014/08/06/notes/'>next <i class="fa fa-chevron-right"></i></a></p>

  <br />

  <p> <a class="btn btn-default" 
         href="https://github.com/cboettig/cboettig.github.io/commits/master/content/lab-notebook/2014-08-07-too-much-fun-with-docker.md"><i class="fa fa-clock-o"></i> history</a></p>

  <p> <i class="fa fa-barcode"></i> SHA: <a href="https://github.com/cboettig/cboettig.github.io/blob/8b51c8d4c3d7198591965001f6393d17787e7f6f/content/lab-notebook/2014-08-07-too-much-fun-with-docker.md">8b51c8d4c</a></p> 


</aside>

    </div>
  </div>
</div>


<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'cboettig';
    var disqus_identifier = '\/2014\/08\/07\/too-much-fun-with-docker\/';
    var disqus_title = '';
    var disqus_url = '\/2014\/08\/07\/too-much-fun-with-docker\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>

<footer class="site-footer">
  <hr />
  <div class="container">

  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://carlboettiger.info/#me">
      <p>
      <script type="text/javascript" src="../../../../js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
           <a rel="foaf:weblog" type="application/atom+xml" href="../../../../index.xml"  
        class="showtooltip" title="RSS feeds for my blog-style entries." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    


    <div class="col-md-4 col-md-offset-1 col-xs-4">
	    <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="../../../../img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="../../../../img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>
</footer>


    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="../../../../js/jquery-1.12.3.min.js"></script>
    <script src="../../../../js/bootstrap.min.js"></script>
    <script src="../../../../js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="../../../../js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-18401403-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

 
