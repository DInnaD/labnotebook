<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.20.2" />
  <meta name="author" content="Carl Boettiger">
  

  
  
  
    
    
    <link rel="stylesheet" href="../../../../css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="../../../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../../css/font-awesome.min.css">
  <link rel="stylesheet" href="../../../../css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  
  
    <link rel="stylesheet" href="../../../../css/cboettig.css">
  
  
  <link rel="alternate" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">
  <link rel="feed" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">

  <link rel="icon" type="image/png" href="../../../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../../img/apple-touch-icon.png">
  <link rel="canonical" href="../../../../2013/10/08/notes/">


  <title> | Boettiger Group</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../../">Boettiger Group</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="../../../../index.html">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../members/">
            
            <span>Members</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../vita/">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../teaching/">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../lab-notebook">
            
            <span>Lab Notebook</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    
      
    

<p>Fisheries data from <span class="showtooltip" title="Glaser S, Fogarty M, Liu H, Altman I, Hsieh C, Kaufman L, MacCall A, Rosenberg A, Ye H and Sugihara G (2013). 'Complex Dynamics May Limit Prediction in Marine Fisheries.' Fish And Fisheries, pp. n/a-n/a. ."><a href="http://dx.doi.org/10.1111/faf.12037">Glaser et al. (2013)</a></span> available at <a href="http://oceaninfo-dev.ucsd.edu/ichthyoplankton/">IchthyoDB</a> Larvae and egg counts.  About 4 GB, initialized in <code>calcofi</code> repo (local only).</p>

<h2 id="reading">Reading</h2>

<h3 id="early-warning">early warning</h3>

<p>with &ldquo;Quickest Detection&rdquo; algorithm described in <span class="showtooltip" title="Carpenter S, Brock W, Cole J and Pace M (2013). 'A New Approach For Rapid Detection of Nearby Thresholds in Ecosystem Time Series.' Oikos, pp. no-no. ."><a href="http://dx.doi.org/10.1111/j.1600-0706.2013.00539.x">Carpenter et al. (2013)</a></span> and used by <span class="showtooltip" title="Batt R, Carpenter S, Cole J, Pace M and Johnson R (2013). 'Changes in Ecosystem Resilience Detected in Automated Measures of Ecosystem Metabolism During A Whole-Lake Manipulation.' Proceedings of The National Academy of Sciences, 110, pp. 17398-17403. ISSN 0027-8424."><a href="http://dx.doi.org/10.1073/pnas.1316721110">Batt et al. (2013)</a></span>, which includes a rather friendly explanation in the appendix (SI).</p>

<p>Uses a likelihood based method along with rather simple models of the probability of being in each state, and interestingly relies on the presence of a control system that has already experienced the transition.</p>

<p>Warning statistic (Shiryaev-Roberts statistic) after seeing the $n$th point is</p>

<p>$$R<em>n = \left(1 + R</em>{n-1}\right) \Lambda$$</p>

<p>where $\Lambda$ is the likelihood ratio of the probability that observation comes from the transitioned system, $g(x_n)$ over the probability that original stable system $f(x_n)$,</p>

<p>$$ \Lambda = \frac{g(x_n)}{f(x_n)} $$</p>

<p>This expression is derived in <span class="showtooltip" title="Polunchenko A and Tartakovsky A (2011). 'State-of-The-Art in Sequential Change-Point Detection.' Methodology And Computing in Applied Probability, 14, pp. 649-684. ISSN 1387-5841."><a href="http://dx.doi.org/10.1007/s11009-011-9256-5">Polunchenko &amp; Tartakovsky (2011)</a></span>, though I haven&rsquo;t followed the derivation in full, it&rsquo;s still not clear to me why we sum the consecutive log ratios.  I would think we needed the product.</p>

<p>To apply this to the warning signal context we need three things: $f$, $g$, and the threshold at which $R_n$ is considered a warning signal, $A$.  Though <span class="showtooltip" title="Polunchenko A and Tartakovsky A (2011). 'State-of-The-Art in Sequential Change-Point Detection.' Methodology And Computing in Applied Probability, 14, pp. 649-684. ISSN 1387-5841."><a href="http://dx.doi.org/10.1007/s11009-011-9256-5">Polunchenko &amp; Tartakovsky (2011)</a></span> derive the threshold given the acceptable error rate and then calculating the expected waiting time to observe such a deviation by chance.  However, <span class="showtooltip" title="Carpenter S, Brock W, Cole J and Pace M (2013). 'A New Approach For Rapid Detection of Nearby Thresholds in Ecosystem Time Series.' Oikos, pp. no-no. ."><a href="http://dx.doi.org/10.1111/j.1600-0706.2013.00539.x">Carpenter et al. (2013)</a></span> and <span class="showtooltip" title="Batt R, Carpenter S, Cole J, Pace M and Johnson R (2013). 'Changes in Ecosystem Resilience Detected in Automated Measures of Ecosystem Metabolism During A Whole-Lake Manipulation.' Proceedings of The National Academy of Sciences, 110, pp. 17398-17403. ISSN 0027-8424."><a href="http://dx.doi.org/10.1073/pnas.1316721110">Batt et al. (2013)</a></span>, prefer to test a range of thresholds $A$ to settle on a value at which the results are not sensitive to perturbations in the choice.  <sup class="footnote-ref" id="fnref:1"><a rel="footnote" href="#fn:1">1</a></sup>.</p>

<p>Rather more curious is the choice of $f$ and $g$. Implementation appears to rely on the presence of a control lake in the transitioned state in order to provide $f$, which is fortunately just the case for the whole-ecosystem lake experiment data. <span class="showtooltip" title="Batt R, Carpenter S, Cole J, Pace M and Johnson R (2013). 'Changes in Ecosystem Resilience Detected in Automated Measures of Ecosystem Metabolism During A Whole-Lake Manipulation.' Proceedings of The National Academy of Sciences, 110, pp. 17398-17403. ISSN 0027-8424."><a href="http://dx.doi.org/10.1073/pnas.1316721110">Batt et al. (2013)</a></span> takes $f$ and $g$ to be Gaussian and of equal variance $\sigma^2$ as estimated from the variance in the control lake.</p>

<p>Ugh, I don&rsquo;t see why the QD algorithm works at all in the context that it is applied for the PNAS and Oikos papers.  It&rsquo;s a change-point method.  It might be one thing if they used this to determine when the shift occurred in the original state space.  But they are using it to detect an increase in the warning indicator (windowed standard deviation) prior to the actual bifurcation.  Okay, sure we can decide that a gradual increase looks more like a sudden jump up than it does a constant flat level with enough time.</p>

<p>Set side concerns that the distributions for the window-averaged sd are demonstrably not normal with fixed mean and variance, as assumed, and not of equal variance, as assumed.  The dynamics of the system itself can be Gaussian, though the system approaching the tipping point has time-dependent mean and variance as given by my equation 3.10 and 3.11 in <span class="showtooltip" title="Boettiger C and Hastings A (2012). 'Quantifying Limits to Detection of Early Warning For Critical Transitions.' Journal of The Royal Society Interface, 9, pp. 2527-2539. ISSN 1742-5689."><a href="http://dx.doi.org/10.1098/rsif.2012.0125">Boettiger &amp; Hastings (2012)</a></span>.  Clearlythe time-windowed variance cannot be modeled as coming from a constant Gaussian process when the whole point is that theory predicts it to be steadily increasing&hellip; Nor can I see any reason the variance in the windowed average sd be the same in the control system as in the manipulated system (a rather unnecessary assumption at any rate since in this case the sd can be estimated separately from the start of the time series of the control and manipulated data respectively).</p>

<p>More troubling, they use the &lsquo;control&rsquo; of a system that has already transitioned as the comparison.  Again that might make sense if we were looking at the original state of the system, but I don&rsquo;t see how that makes any sense when looking for a change in the system standard deviation.  The warning signal is based on the assumption that the standard deviation increases as the eigenvalue approaches zero (the bifurcation).  So the change we want to see is the difference between what standard deviations we get when the eigenvalue is not zero and we&rsquo;re far from the bifurcation, and those of the eigenvalue near zero.  It doesn&rsquo;t matter what the eigenvalue (and therefore standard deviation) is at the other alternative stable state. And if the other state is truly stable, then if anything using it as the reference is positively misleading. And yet they detect transitions in both the real and simulated data.  I think I must be missing something.</p>

<h2 id="misc-reading">Misc reading</h2>

<p>Ambitious Gillespie model for stochastic population dynamics in <span class="showtooltip" title="Kramer A, Lyons M, Dobbs F and Drake J (2013). 'Bacterial Colonization And Extinction on Marine Aggregates: Stochastic Model of Species Presence And Abundance.' Ecology And Evolution, 3, pp. 4300-4309. ."><a href="http://dx.doi.org/10.1002/ece3.789">Kramer et al. (2013)</a></span>.  Interesting to see the paper use GillespieSSA, though from eariler emails with Mario I understand my pure C approach of the exact algorithm is still faster than the R implementation using the coarse-grained tau-leaping approach.</p>

<h2 id="references">References</h2>

<ul>
<li>R. D. Batt, S. R. Carpenter, J. J. Cole, M. L. Pace, R. A. Johnson,   (2013) Changes in Ecosystem Resilience Detected in Automated Measures of Ecosystem Metabolism During A Whole-Lake Manipulation.  <em>Proceedings of The National Academy of Sciences</em>  <strong>110</strong>  17398-17403  <a href="http://dx.doi.org/10.1073/pnas.1316721110">10.1073/pnas.1316721110</a></li>
<li>C. Boettiger, A. Hastings,   (2012) Quantifying Limits to Detection of Early Warning For Critical Transitions.  <em>Journal of The Royal Society Interface</em>  <strong>9</strong>  2527-2539  <a href="http://dx.doi.org/10.1098/rsif.2012.0125">10.1098/rsif.2012.0125</a></li>
<li>Stephen R. Carpenter, William A. Brock, Jonathan J. Cole, Michael L. Pace,   (2013) A New Approach For Rapid Detection of Nearby Thresholds in Ecosystem Time Series.  <em>Oikos</em>  no-no  <a href="http://dx.doi.org/10.1111/j.1600-0706.2013.00539.x">10.1111/j.1600-0706.2013.00539.x</a></li>
<li>Sarah M Glaser, Michael J Fogarty, Hui Liu, Irit Altman, Chih-Hao Hsieh, Les Kaufman, Alec D MacCall, Andrew A Rosenberg, Hao Ye, George Sugihara,   (2013) Complex Dynamics May Limit Prediction in Marine Fisheries.  <em>Fish And Fisheries</em>  n/a-n/a  <a href="http://dx.doi.org/10.1111/faf.12037">10.1111/faf.12037</a></li>
<li>Andrew M. Kramer, M. Maille Lyons, Fred C. Dobbs, John M. Drake,   (2013) Bacterial Colonization And Extinction on Marine Aggregates: Stochastic Model of Species Presence And Abundance.  <em>Ecology And Evolution</em>  <strong>3</strong>  4300-4309  <a href="http://dx.doi.org/10.1002/ece3.789">10.1002/ece3.789</a></li>
<li>Aleksey S. Polunchenko, Alexander G. Tartakovsky,   (2011) State-of-The-Art in Sequential Change-Point Detection.  <em>Methodology And Computing in Applied Probability</em>  <strong>14</strong>  649-684  <a href="http://dx.doi.org/10.1007/s11009-011-9256-5">10.1007/s11009-011-9256-5</a></li>
</ul>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1">Under the Gaussian models they assume I suspect something can be proven about this to the effect that the larger the threshold the less sensitive it should be, as the chance of a random deviation becomes more and more unlikely farther into the tails. The Shiryaev-Roberts statistic shown in Figure 1&copy; of the Oikos paper illustrates this insensitive range for A &ndash; the jump is very sharp.<br />
 <a class="footnote-return" href="#fnref:1"><sup>[return]</sup></a></li>
</ol>
</div>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:http://ogp.me/ns/article#">
  
  
  
<div class="article-metadata">

  <p>
  <span class="article-date">
    <i class="fa fa-calendar"></i>
    
    <time datetime="2013-10-08 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Tue, Oct 8, 2013
    </time>
    
  </span>
  </p>
    

  <p>
  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="../../../../categories/ecology">ecology</a
    >
    
  </span>
  
  
  </p>
  
  <p>
  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="../../../../tags/warning-signals">warning-signals</a
    >
    
  </span>
  
  
  </p>

</div>

 
  <br />
  
  <p><a class="btn btn-default" rel="prev" href='../../../../2013/10/09/notes/'><i class="fa fa-chevron-left"></i> prev</a>
    <a class="btn btn-default" rel="next" href='../../../../2013/10/07/nexml-phylo-class-extension/'>next <i class="fa fa-chevron-right"></i></a></p>

  <br />

  <p> <a class="btn btn-default" 
         href="https://github.com/cboettig/cboettig.github.io/commits/master/content/lab-notebook/2013-10-08-notes.md"><i class="fa fa-clock-o"></i> history</a></p>

  <p> <i class="fa fa-barcode"></i> SHA: <a href="https://github.com/cboettig/cboettig.github.io/blob/cd98680d81d38b2d90af25cb09955cd205505b2c/content/lab-notebook/2013-10-08-notes.md">cd98680d8</a></p> 


</aside>

    </div>
  </div>
</div>


<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'cboettig';
    var disqus_identifier = '\/2013\/10\/08\/notes\/';
    var disqus_title = '';
    var disqus_url = '\/2013\/10\/08\/notes\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>

<footer class="site-footer">
  <hr />
  <div class="container">

  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://carlboettiger.info/#me">
      <p>
      <script type="text/javascript" src="../../../../js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
           <a rel="foaf:weblog" type="application/atom+xml" href="../../../../index.xml"  
        class="showtooltip" title="RSS feeds for my blog-style entries." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    


    <div class="col-md-4 col-md-offset-1 col-xs-4">
	    <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="../../../../img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="../../../../img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>
</footer>


    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="../../../../js/jquery-1.12.3.min.js"></script>
    <script src="../../../../js/bootstrap.min.js"></script>
    <script src="../../../../js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="../../../../js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-18401403-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

 
