<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.20.2" />
  <meta name="author" content="Carl Boettiger">
  

  
  
  
    
    
    <link rel="stylesheet" href="../../../../css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="../../../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../../css/font-awesome.min.css">
  <link rel="stylesheet" href="../../../../css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  
  
    <link rel="stylesheet" href="../../../../css/cboettig.css">
  
  
  <link rel="alternate" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">
  <link rel="feed" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">

  <link rel="icon" type="image/png" href="../../../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../../img/apple-touch-icon.png">
  <link rel="canonical" href="../../../../2013/04/05/a-clever-derivation-on-realized-escape-times/">


  <title> | Boettiger Group</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../../">Boettiger Group</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="../../../../index.html">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../members/">
            
            <span>Members</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../vita/">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../teaching/">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../lab-notebook">
            
            <span>Lab Notebook</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    
      
    

<p>I have often observed (e.g. <span class="showtooltip" title="Boettiger C and Hastings A (2012). Early Warning Signals And The
Prosecutor'S Fallacy. _Proceedings of The Royal Society B:
Biological Sciences_, *279*, pp. 4734-4739. ISSN 0962-8452, 
http://dx.doi.org/10.1098/rspb.2012.2085."><a href="http://dx.doi.org/10.1098/rspb.2012.2085" rel="http://purl.org/spar/cito/citesAsEvidence" >Boettiger &amp; Hastings (2012)</a></span> ) that if purely stochastic transitions out of a potential well happen, then they happen fast (dispite the fact that waiting time for them to happen is very long).  Yesterday Marc mentioned an interesting proof of this from Don Ludwig, who was able to show that the waiting time to reach a large deviation in a time $t$, given that it reaches it at all, is of the same order as the return time from the large deviation to the equilibrium, $\log(L/\sigma)$.  That&rsquo;s an absolutely fascinating conclusion, indeed a bit stronger than even I had expected (the waiting time until an escape is observed rather different! &ndash; of order $\exp(L^2/\sigma^2)$.</p>

<p>Don&rsquo;s derivation is repeated in pages 302-311 Marc&rsquo;s &ldquo;Theoretical Biologist&rsquo;s Toolbox,&rdquo; rather delightfully too (e.g. the &ldquo;Kumura Maneuver&rdquo;, or sidenotes such as &ldquo;it is also kind of fun to do a web search with key words â€˜Dawson&rsquo;s Integral&rsquo;&rdquo;).  <span class="showtooltip" title="Lande R (1985). Expected time for random genetic drift of a
population between stable phenotypic states. 
http://www.pnas.org/content/82/22/7641.abstract [Online.
last-accessed: 2013-04-08 19:58:49]. 
http://www.pnas.org/content/82/22/7641.abstract."><a href="http://www.pnas.org/content/82/22/7641.abstract" rel="http://purl.org/spar/cito/citesForInformation" >Lande (1985)</a></span>  provides a somewhat different derivation of the same result.</p>

<h2 id="return-time">Return time</h2>

<p>The return time calculation is straight forward.  Consider our OU model</p>

<p>$$dX = - X dt + \sigma dB_t$$</p>

<p>We ask for the return time into a neighborhood $\sigma$ of the origin, starting at $X_0 = L$ distant from the origin.  The deterministic solution</p>

<p>$$ \tfrac{dx}{dt} = - x $$</p>

<p>implies $x_t = L (1 - e^{-t}) $, so setting $x_t = \sigma_t$ and solving for $t$, we find that $x_t$ is within $\sigma$ of $t$ in time $\log{L} - \log{\sigma}$, or $\log{L/\sigma}$, as claimed.</p>

<h2 id="waiting-time">Waiting time</h2>

<p>The time we must wait before any trajectory can reach a given boundary is a classic hitting-time problem for the OU process that can be solved in several ways.  Any of these basically start from PDE that must be satisfied for the hitting time (e.g. see Crispin Gardner, Stochastic Methods) for the OU process at stationary state ($T_t = 0$),</p>

<p>$$ \tfrac{\sigma^2}{2} T_{xx} - x T_x = -1 $$</p>

<p>With the appropriate boundary conditions $T(L) = T(-L) = 0$.  A little integration (see Dynkin&rsquo;s formula) shows this scales as $\exp(L^2/\sigma^2)$ (Compare to the Brownian walk that doesn&rsquo;t have to escape any pull, which escapes at rate $L^2/\sigma^2$.</p>

<h2 id="exit-time">Exit time</h2>

<p>Most trajectories will thus return many times to the origin (stable point) before finally escaping.  But if we focus just on the part of the trajectory from some value near the origin, that eventually escapes without ever crossing the origin again,</p>

<p>$$u_t(x,t) dt = Pr\left(\textrm{exit from }(0; L]\textrm{in the interval } (t, t + dt) \textrm{without having crossed} 0 | X(0) = x\right)$$</p>

<p>We are interested in comparing the average time taken by trajectories exiting by time $t$ relative to the probability of exiting at all (i.e. as $t \to \infty$),</p>

<p>$$ T_c(x) = \frac{\int^{\infty}_0 t u<em>t(x,t) dt }{\lim</em>{t \to \infty} u(x,t) }$$</p>

<p>From here we set up the classic hitting time solution for the OU for the <em>time-dependent</em> PDE,</p>

<p>$$u<em>t = \frac{\sigma^2}{2} u</em>{xx} = x u_x $$</p>

<p>and with initial condition $u(x,t=0) = 0$, $u(0,t) = 0$, and $u(L, t) = 1$.  A bit of effort and an approximation to Dawson&rsquo;s integral for $L \gg x$ leads Don to bound the mean time to exit,</p>

<p>$$T_c(x) &lt; \frac{1}{\sigma} \log\left(\frac{L}{\sigma}\right)$$</p>

<p>as claimed.</p>

<h2 id="results-from-marc-s-other-suggestion">Results from Marc&rsquo;s other suggestion</h2>

<p>Marc also suggested exploring this by directly comparing steps left and right.  A related way to measure the relative number of steps in the positive direction relative to the negative direction is Kendall&rsquo;s tau rank correlation coefficient, which also looks at the number of increases relative to the number of decreases.</p>

<p>I&rsquo;ve computed this statistic for my sample trajectories and plotted as a histogram here.  The negative skew shows the tendancy to decrease (which is the direction of the deviation I selected &ndash; smaller population sizes)</p>

<p><img src="http://farm9.staticflickr.com/8263/8621413072_3597b335fe_o.png" alt="" /></p>

<p>I&rsquo;ve also computed the ratio of steps up to steps down and histogrammed that: like the above, it shows more steps down than up, though not as dramatic as I might think by any means.  Have to think about the role of the step size between observations in formulating this perhaps.</p>

<p><img src="http://farm9.staticflickr.com/8113/8621413020_5d779e8b1f_o.png" alt="" /></p>

<p>For the sake of completeness:</p>

<ul>
<li><a href="https://github.com/cboettig/earlywarning/blob/8418a20cabf24786b54acc51eb508e9dbf3d1b37/inst/examples/trajectories.csv">data for the trajectories is here</a></li>
<li><a href="https://github.com/cboettig/earlywarning/blob/8418a20cabf24786b54acc51eb508e9dbf3d1b37/inst/examples/beer.md">code for the analysis is here</a></li>
</ul>

<p>I may try and add a demonstration of Ludwig&rsquo;s result above when I get some more free time to fiddle; will just need to add some additional simulations of return trajectories.</p>

<h2 id="references">References</h2>

<ul>
<li>C. Boettiger, A. Hastings,   (2012) Early Warning Signals And The Prosecutor&rsquo;S Fallacy.  <em>Proceedings of The Royal Society B: Biological Sciences</em>  <strong>279</strong>  4734-4739  <a href="http://dx.doi.org/10.1098/rspb.2012.2085">10.1098/rspb.2012.2085</a></li>
<li>R Lande,   (1985) Expected time for random genetic drift of a population between stable phenotypic states.  <em>Proceedings of the National Academy of Sciences</em>  <a href="http://www.pnas.org/content/82/22/7641.abstract">http://www.pnas.org/content/82/22/7641.abstract</a></li>
</ul>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:http://ogp.me/ns/article#">
  
  
  
<div class="article-metadata">

  <p>
  <span class="article-date">
    <i class="fa fa-calendar"></i>
    
    <time datetime="2013-04-05 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Fri, Apr 5, 2013
    </time>
    
  </span>
  </p>
    

  <p>
  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="../../../../categories/ecology">ecology</a
    >
    
  </span>
  
  
  </p>
  
  <p>
  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="../../../../tags/derivation">derivation</a
    >, 
    
    <a href="../../../../tags/prosecutor">prosecutor</a
    >, 
    
    <a href="../../../../tags/warning-signals">warning-signals</a
    >, 
    
    <a href="../../../../tags/adaptive-dynamics">adaptive-dynamics</a
    >
    
  </span>
  
  
  </p>

</div>

 
  <br />
  
  <p><a class="btn btn-default" rel="prev" href='../../../../2013/04/10/fun-and-not-so-fun-with-bibliographic-apis/'><i class="fa fa-chevron-left"></i> prev</a>
    <a class="btn btn-default" rel="next" href='../../../../2013/04/04/notebook-parsing/'>next <i class="fa fa-chevron-right"></i></a></p>

  <br />

  <p> <a class="btn btn-default" 
         href="https://github.com/cboettig/cboettig.github.io/commits/master/content/lab-notebook/2013-04-05-a-clever-derivation-on-realized-escape-times.md"><i class="fa fa-clock-o"></i> history</a></p>

  <p> <i class="fa fa-barcode"></i> SHA: <a href="https://github.com/cboettig/cboettig.github.io/blob/cd98680d81d38b2d90af25cb09955cd205505b2c/content/lab-notebook/2013-04-05-a-clever-derivation-on-realized-escape-times.md">cd98680d8</a></p> 


</aside>

    </div>
  </div>
</div>


<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'cboettig';
    var disqus_identifier = '\/2013\/04\/05\/a-clever-derivation-on-realized-escape-times\/';
    var disqus_title = '';
    var disqus_url = '\/2013\/04\/05\/a-clever-derivation-on-realized-escape-times\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>

<footer class="site-footer">
  <hr />
  <div class="container">

  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://carlboettiger.info/#me">
      <p>
      <script type="text/javascript" src="../../../../js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
           <a rel="foaf:weblog" type="application/atom+xml" href="../../../../index.xml"  
        class="showtooltip" title="RSS feeds for my blog-style entries." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    


    <div class="col-md-4 col-md-offset-1 col-xs-4">
	    <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="../../../../img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="../../../../img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>
</footer>


    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="../../../../js/jquery-1.12.3.min.js"></script>
    <script src="../../../../js/bootstrap.min.js"></script>
    <script src="../../../../js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="../../../../js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-18401403-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

 
