<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.20.2" />
  <meta name="author" content="Carl Boettiger">
  

  
  
  
    
    
    <link rel="stylesheet" href="../../../../css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="../../../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../../css/font-awesome.min.css">
  <link rel="stylesheet" href="../../../../css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  
  
    <link rel="stylesheet" href="../../../../css/cboettig.css">
  
  
  <link rel="alternate" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">
  <link rel="feed" href="../../../../index.xml" type="application/rss+xml" title="Boettiger Group">

  <link rel="icon" type="image/png" href="../../../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../../img/apple-touch-icon.png">
  <link rel="canonical" href="../../../../2012/09/27/migrating-oww-posts-to-jekyll/">


  <title> | Boettiger Group</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../../">Boettiger Group</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="../../../../index.html">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../members/">
            
            <span>Members</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../vita/">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../teaching/">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../../lab-notebook">
            
            <span>Lab Notebook</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    
      
    

<p>This Open Lab Notebook started on a public MediaWiki-based site, <a href="http://openwetware.org">OpenWetWare</a> (OWW), which was created with the ambitious vision of having a single wiki for biological sciences (or at least, synthetic microbiology, since such the wiki grew out of a collection of such labs).  Users could have their own pages that served as a personal website or lab group site, contribute pages on specific protocols, host course websites, and most interestingly, were encouraged to create open lab notebooks using specially designed templates for the purpose.  From January through October of 2010, I kept all my notes in two separate OWW notebooks: one for entries on my <a href="http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Comparative_Phylogenetics">Comparative Phylogenetics</a> research, and a seperate one for entries in <a href="http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Stochastic_Population_Dynamics">Stochastic Population Dynamics</a>. Each notebook had a cover page and then entries by day, linked by the calendar box on the cover page.  This was a neat idea an excellent introduction into the world of open lab notebooks.</p>

<p>In September of 2010 I began to leave the OpenWetWare platform to start my own lab notebook based on a privately hosted copy Wordpress. The benefits of being on a shared community platform were minimized by the relatively small number of active users mostly belonging to a different field.  Downtime on the site and a lack of any easy way to access my content off-line or back up content also made me increasingly nervous, while the difficulty in adding additional tools or functionality (such as RSS feeds to new entries, personal tags, improved search) collectively spurred my decision to move to Wordpress. At the time I had knew of no easy way to migrate my OWW posts, so I allowed them to remain where they were while I continued further notes in my newly minted Wordpress installation.</p>

<p>In April of 2012 I began to experiment with the static-blogging engine, Jekyll. My adoption of markdown, facilitated by my discovery of pandoc and the advent of <code>knitr</code>, together with my complete submersion into a Github-based workflow led me to first consider Jekyll.  Wordpress was slow and heavy, both for creating entries in the online editor (though I did start pushing markdown-based entries to Wordpress through it&rsquo;s API and the associated R package).  Though Jekyll has a slightly steeper learning curve to start, once you have the basics down complicated things aren&rsquo;t any harder than easy ones, whereas on Wordpress the basics are trivial but complex customization becomes a full-time web-developer challenge.  In Jekyll, it was rather easy to migrate all my old entries from the previous platforms onto the new one.</p>

<p>In the <a href="http://www.carlboettiger.info/2012/09/19/migrating-from-wordpress-to-jekyll.html">previous post</a> I describe exporting my Wordpress-based entries using a python script from Thomas Frossman. To export my OpenWetWare entries I relied on the rather excellent MediaWiki API. While I began by grabbing the content of each post in MediaWiki syntax, I soon realized it was easier to grab the content already parsed as HTML (using a different API call) and then parse the HTML into markdown using Pandoc. (Pandoc&rsquo;s developmental version does have experimental support for reading MediaWiki syntax now).  I then added a few substitutions to standardize my tags and categories.  Here&rsquo;s my R call to the MediaWiki API (see <a href="https://github.com/cboettig/sandbox/blob/1efa80e913006051083544275f6af9b5ab9ccb0a/wiki_get.R">wiki_get.R</a>):</p>

<pre><code class="language-r">wiki_parse &lt;- function(page, baseurl, format=&quot;json&quot;, ...){
  require(httr)
  action = &quot;parse&quot;
  addr &lt;- paste(baseurl, &quot;/api.php?format=&quot;, format, &quot;&amp;action=&quot;, action, &quot;&amp;page=&quot;, page, sep=&quot;&quot;)
  config &lt;- c(add_headers(&quot;User-Agent&quot; = &quot;rwiki&quot;), ...)
  out &lt;- GET(addr, config=config)
  parsed_content(out)
}
</code></pre>

<p>I create a few helper functions for parsing the html into markdown, and also extracting and adding the metadata into Jekyll&rsquo;s YAML headers (see <a href="https://github.com/cboettig/sandbox/blob/1efa80e913006051083544275f6af9b5ab9ccb0a/export_oww.R">export_oww.R</a>)</p>

<pre><code class="language-r">require(httr)
require(gsubfn)

oww_to_md &lt;- function(pages, user=&quot;Carl_Boettiger&quot;,  baseurl = &quot;http://openwetware.org&quot;){
  # Store filenames (with dates) and categories for each page, for reference later
  filenames &lt;- get_filenames(pages)
  categories &lt;- get_categories(pages)
  ## Use the API function to extract the content
  parsed &lt;- export_oww(pages, user, baseurl)
  ## Add the baseurl back into all the links
  htmls &lt;- add_baseurl(parsed)
  ## Create YAML header text
  headers &lt;- add_header_txt(parsed, categories)
  ## Use pandoc to convert the html to markdown
  mds &lt;- html_to_md(htmls, filenames) 
  ## Delete the OWW header info we don't want in the markdown
  mds &lt;- clean_md(mds)
  ## Stick headers onto markdown files and name them according to filenames
  write_mds(mds, headers, filenames) 
}

get_filenames &lt;- function(pages){
  lapply(pages, function(p){
    p &lt;- gsub(&quot; &quot;, &quot;_&quot;, p)
    filename &lt;- gsub(&quot;/&quot;, &quot;-&quot;, p)
    filename &lt;- gsub(&quot;(.*)-(\\d+-\\d+-\\d+)&quot;, &quot;\\2-\\1&quot;, filename)
  })
}

#' Take a list of page titles to a user's OWW notebooks and export them as Jekyll markdown entries.  
get_categories &lt;- function(pages){
  lapply(pages, function(p){
    p &lt;- gsub(&quot;_&quot;, &quot; &quot;, p)
    filename &lt;- gsub(&quot;/&quot;, &quot;-&quot;, p)
    category &lt;- gsub(&quot;(.*)-(\\d+-\\d+-\\d+)&quot;, &quot;\\1&quot;, filename)
  })
}


#' Take a list of page titles to a user's OWW notebooks and export them as Jekyll markdown entries.  
export_oww &lt;- function(pages, user=&quot;Carl_Boettiger&quot;,  baseurl=  &quot;http://openwetware.org&quot;){
  lapply(pages, function(p){
    p &lt;- gsub(&quot; &quot;, &quot;_&quot;, p)
    page &lt;- paste(&quot;User:&quot;, user, &quot;/Notebook/&quot;, p, sep=&quot;&quot;)
    out &lt;- wiki_parse(page, baseurl=baseurl)
  })
}

add_baseurl &lt;- function(parsed,  baseurl = &quot;http://openwetware.org&quot;){
  lapply(parsed, function(out){
    html &lt;- out$parse$text[[1]]
    html &lt;- gsubfn(&quot;src=\&quot;/images/&quot;, paste(&quot;src=\&quot;&quot;, 
                   baseurl,&quot;/images/&quot;, sep=&quot;&quot;), html)
    html &lt;- gsubfn(&quot;href=\&quot;/wiki/&quot;, paste(&quot;src=\&quot;&quot;, 
                   baseurl,&quot;/wiki/&quot;, 
                    sep=&quot;&quot;), html)
  })
}

add_header_txt &lt;- function(parsed, mycategories){
  sapply(1:length(parsed), function(i){
    out &lt;- parsed[[i]]
    category &lt;- mycategories[[i]]
    if(length(out$parse$categories)&gt;0){
      categories &lt;- sapply(out$parse$categories, function(x) x$`*`)
      gsub(&quot;_&quot;, &quot; &quot;, categories)
      ## Standarize some of my tags, called &quot;categories&quot; on OWW
      tags &lt;- paste(&quot;tags: &quot;, &quot;[&quot;, 
                          paste0(categories, collapse = &quot;, &quot;),
                          &quot;]&quot;, sep=&quot;&quot;)  
    } else {
      tags &lt;- &quot;&quot;
    }
    
    header &lt;- c(&quot;---&quot;, 
                &quot;layout: post&quot;,
                tags, 
                paste(&quot;categories: &quot;, category),
                &quot;---\n\n&quot;)
  })
}


html_to_md &lt;- function(htmls, filenames){
  lapply(1:length(htmls), function(html){
    writeLines(htmls[[i]], paste(filenames[i], &quot;.html&quot;, sep=&quot;&quot;))
    md &lt;- system(paste(&quot;pandoc &quot;, filenames[i], &quot;.html -w markdown&quot;, 
                       sep=&quot;&quot;), intern=TRUE)
  })
}


clean_md &lt;- function(mds){
  lapply(mds, function(md){
    ## Remove OWW header
    md &lt;- gsub(&quot;!\\[image\\]\\(http://openwetware.org/images/f/f8/Owwnotebook_icon.png\\)&quot;, &quot;&quot;, md)
    md &lt;- gsub(&quot;!\\[image\\]\\(http://openwetware.org/images/9/94/Report.png\\)&quot;,  &quot;&quot;, md)
    md &lt;- gsub(&quot;Main project&quot;, &quot;&quot;, md)
    md &lt;- gsub(&quot;page\\\\&quot;, &quot;&quot;, md)
    md &lt;- gsub(&quot;!\\[image\\]\\(http://openwetware.org/images/c/c3/Resultset_previous.png\\)&quot;,  &quot;&quot;, md)
    md &lt;- gsub(&quot;Previous$&quot;,  &quot;&quot;, md)
    md &lt;- gsub(&quot;^entry Next$&quot;, &quot;&quot;, md)
    md &lt;- gsub(&quot;!\\[image\\]\\(http://openwetware.org/images/5/5c/Resultset_next.png\\)&quot;, &quot;&quot;, md)
    md &lt;- gsub(&quot;^entry$&quot;, &quot;&quot;, md)
    md &lt;- gsub(&quot;^Stochastic Population Dynamics&quot;, &quot;&quot;, md)
    md &lt;- gsub(&quot;^Comparative Phylogenetics$&quot;, &quot;&quot;, md)
    md &lt;- gsub(&quot;^Teaching$&quot;, &quot;&quot;, md)
  })
}



write_md &lt;- function(mds, headers, filenames){
  lapply(1:length(mds), function(i){
    writeLines(c(headers[[i]], mds[[i]]), paste(filenames[i], &quot;.markdown&quot;, sep=&quot;&quot;)) 
  })
}
</code></pre>

<p>If or when I change platform again, it should be even easier. With all my posts in markdown, I can easily move them into an ebook or pdf using Pandoc (currently requires stripping the YAML headers first, though it would be great if Pandoc eventually supported metadata headers in YAML).  Github renders the markdown of each post automatically, so the content of most posts can be read directly from the Github repository, <a href="https://github.com/cboettig/labnotebook/tree/master/_posts">cboettig/labnotebook</a>.</p>

<h2 id="misc-tricks">Misc tricks</h2>

<p>The unix <code>rename</code> utility comes in handy:</p>

<pre><code>rename 's/Comparative_Phylogenetics/Comparative-Phylogenetics-Notebook-(from-OWW)/' *Comparative_Phylogenetics.markdown
rename 's/Stochastic_Population_Dynamics/Stochastic-Population-Dynamics-Notebook-(from-OWW)/' *Stochastic_Population_Dynamics.markdown
</code></pre>

<p>And a vim mapping to flip through 100s of source files quickly:</p>

<pre><code>:map &lt;F2&gt; :N&lt;CR&gt;
:map &lt;F3&gt; :n&lt;CR&gt;
</code></pre>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:http://ogp.me/ns/article#">
  
  
  
<div class="article-metadata">

  <p>
  <span class="article-date">
    <i class="fa fa-calendar"></i>
    
    <time datetime="2012-09-27 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Thu, Sep 27, 2012
    </time>
    
  </span>
  </p>
    

  <p>
  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="../../../../categories/open-science">open-science</a
    >
    
  </span>
  
  
  </p>
  
  <p>
  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="../../../../tags/notebook-technology">notebook-technology</a
    >, 
    
    <a href="../../../../tags/jekyll">Jekyll</a
    >, 
    
    <a href="../../../../tags/code-tricks">code-tricks</a
    >
    
  </span>
  
  
  </p>

</div>

 
  <br />
  
  <p><a class="btn btn-default" rel="prev" href='../../../../2012/09/28/welcome-to-my-lab-notebook/'><i class="fa fa-chevron-left"></i> prev</a>
    <a class="btn btn-default" rel="next" href='../../../../2012/09/19/migrating-from-wordpress-to-jekyll/'>next <i class="fa fa-chevron-right"></i></a></p>

  <br />

  <p> <a class="btn btn-default" 
         href="https://github.com/cboettig/cboettig.github.io/commits/master/content/lab-notebook/2012-09-27-Migrating-OWW-posts-to-Jekyll.md"><i class="fa fa-clock-o"></i> history</a></p>

  <p> <i class="fa fa-barcode"></i> SHA: <a href="https://github.com/cboettig/cboettig.github.io/blob/9d9072923c46d635718a4624d6afff6b1ec2439f/content/lab-notebook/2012-09-27-Migrating-OWW-posts-to-Jekyll.md">9d9072923</a></p> 


</aside>

    </div>
  </div>
</div>


<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'cboettig';
    var disqus_identifier = '\/2012\/09\/27\/migrating-oww-posts-to-jekyll\/';
    var disqus_title = '';
    var disqus_url = '\/2012\/09\/27\/migrating-oww-posts-to-jekyll\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>

<footer class="site-footer">
  <hr />
  <div class="container">

  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://carlboettiger.info/#me">
      <p>
      <script type="text/javascript" src="../../../../js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
           <a rel="foaf:weblog" type="application/atom+xml" href="../../../../index.xml"  
        class="showtooltip" title="RSS feeds for my blog-style entries." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    


    <div class="col-md-4 col-md-offset-1 col-xs-4">
	    <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="../../../../img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="../../../../img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>
</footer>


    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="../../../../js/jquery-1.12.3.min.js"></script>
    <script src="../../../../js/bootstrap.min.js"></script>
    <script src="../../../../js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="../../../../js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-18401403-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

 
