<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.21-DEV" />
  <meta name="author" content="Carl Boettiger">
  

  
  
  
    
    
    <link rel="stylesheet" href="../../../css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="../../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../css/font-awesome.min.css">
  <link rel="stylesheet" href="../../../css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  
  
    <link rel="stylesheet" href="../../../css/cboettig.css">
  
  
  <link rel="alternate" href="../../../index.xml" type="application/rss+xml" title="Boettiger Group">
  <link rel="feed" href="../../../index.xml" type="application/rss+xml" title="Boettiger Group">

  <link rel="icon" type="image/png" href="../../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../../img/apple-touch-icon.png">
  <link rel="canonical" href="../../../2012/01/19/is-your-phylogeny-informative.html">


  <title>Is your phylogeny informative? | Boettiger Group</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../">Boettiger Group</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="../../../index.html">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../members/">
            
            <span>Members</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../vita/">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../teaching/">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="../../../lab-notebook">
            
            <span>Lab Notebook</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-7 col-md-offset-1">
    <article>
    <h1>Is your phylogeny informative?</h1> 
      
    

<p>Yesterday my paper (Boettiger <em>et. al.</em> 2012)  appeared in early view in Evolution (<a href="http://www.mendeley.com/download/public/98752/4485545655/9a209c7dd29980fd2e47c06eb8b2d1d7dd6f70d4/dl.pdf">author&rsquo;s preprint</a>),As the open access copy doesn&rsquo;t appear on pubmed for a while, you can access my author&rsquo;s copy <a href="http://www.mendeley.com/download/public/98752/4485545655/9a209c7dd29980fd2e47c06eb8b2d1d7dd6f70d4/dl.pdf">here</a>. so I&rsquo;d like to take this chance to share the back-story and highlight my own view on some of our findings, and the associated <a href="http://cran.r-project.org/web/packages/pmc/index.html">package on CRAN</a>.Just submitted, meanwhile, the code is always on <a href="https://github.com/cboettig/pmc">github</a>.</p>

<p>I didn&rsquo;t set out to write this paper.  I set out to write a very different paper, introducing a new phylogenetic method for continuous traits that estimates changes in evolutionary constraint.  This adds _even more _parameters than already present in rich models multi-peak OU process, and I wanted to know if it could be justified &ndash; if there really was enough information to play the game we already had, before I went and made the situation even worse.  Trying to find something rigorous enough to hang my hat on, I ended up writing this paper.</p>

<h3 id="the-short-of-it">The short of it</h3>

<p>There&rsquo;s essentially three conclusions I draw from the paper.</p>

<ol>
<li><p>AIC is not a reliable way to select models.</p></li>

<li><p>Certain parameters, such as $\lambda$, a measure of &ldquo;phylogenetic signal,&rdquo; (Pagel, 1999) are going to be really hard to estimate.</p></li>

<li><p>BUT as long as we <em>simulate extensively</em> to test model choice and parameter uncertainty, we won&rsquo;t be misled by either of these.  So it&rsquo;s okay to drink the koolaid (Losos, 2011), but **drink responsibly.
**</p></li>
</ol>

<h3 id="a-few-reflections">A few reflections</h3>

<p>I really have two problems with AIC and other information criteria when it comes to phylogenetic methods.  One is that it&rsquo;s too easy to simulate data from one model, and have the information criteria choose a ridiculously over-parameterized model instead.  In one example, the wrong model has a $\Delta$AIC of 10 points over the correct model.</p>

<p>But a more basic problem is that it&rsquo;s just not designed for hypothesis testing &ndash; it doesn&rsquo;t care how much data you have, it doesn&rsquo;t give a notion of significance.  If we&rsquo;re ascribing biological meaning to different models as different hypotheses, we need want a measure of uncertainty.</p>

<p>When estimating parameters that scale branch length, I think we must be cautious because these are really data-hungry, and don&rsquo;t work well on small trees. Check out how few of these estimates of lambda on 100 replicate datasets hit near the correct value shown by vertical line:</p>

<p><img src="http://farm8.staticflickr.com/7014/6727029515_bcfe58aedb_o.png" alt="" /></p>

<p>The package commands are explained in more detail in the <strong><a href="http://cran.r-project.org/web/packages/pmc/vignettes/pmc_tutorial.pdf"> package vignette</a></strong>, but the idea is simple. Running the pmc comparison between two models (for the model-choice step) looks like this:</p>

<pre><code class="language-r">bm_v_lambda &lt;- pmc(geospiza.tree, geospiza.data[&quot;wingL&quot;],
  &quot;BM&quot;, &quot;lambda&quot;, nboot=100)
</code></pre>

<p>Extracting the distribution of estimates for the parameter lambda got from fitting the lambda model (B) to data made by simulating under lambda model (A):</p>

<pre><code class="language-r">lambdas &lt;- subset(bm_v_lambda[&quot;par_dists&quot;],
  comparison==&quot;BB&quot; &amp; parameter==&quot;lambda&quot;)
</code></pre>

<p>To view the model comparison, just plot the pmc result:</p>

<pre><code class="language-r">plot(bm_v_lambda)
</code></pre>

<p>The substantial overlap in the likelihood ratios after simulating under either model indicate that we cannot choose between BM and lambda in this case.  I&rsquo;ll leave the paper to explain this approach in more detail, but it&rsquo;s just simulation and refitting.</p>

<p><img src="http://farm8.staticflickr.com/7026/6727293465_4a2a545fdf_o.png" alt="" /></p>

<p>You could just bootstrap the likelihoods or for nested models, look at the parameter distributions, but you get the maximum <em>statistical power</em> from the ratio (says Neyman-Pearson Lemma).</p>

<h3 id="a-technical-note-mix-and-match-formats">A technical note: mix and match formats</h3>

<p>Many users don&rsquo;t like going between ouch format and ape/phylo formats. The pmc package doesn&rsquo;t care what you use, feel free to mix and match. In case the conversion tools are useful, I&rsquo;ve provided functions to move your data and trees back and forth between those formats too.  See _format<em>data()</em> to data-frames and <em>convert()</em> to toggle between tree formats.</p>

<h2 id="reproducible-research">Reproducible Research</h2>

<p>The package is designed to make things easier.  It comes with a vignette (written in sweave) showing just what commands to run to replicate the results from the manuscript.</p>

<p>This entire project has been documented in my open lab notebook from its <a href="http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Comparative_Phylogenetics/2010/02/07">inception</a>. Posts prior to October 2010 can be found on my <a href="http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Comparative_Phylogenetics/2010">OWW notebook</a>, the rest in my current <a href="http://www.carlboettiger.info/archives/category/phylogenetics">phylogenetics notebook</a> (here on wordpress). Of course this project is interwoven with many notes on related and more recent work.</p>

<h2 id="additional-methods-and-feedback">Additional methods and feedback</h2>

<p>As we discuss in the paper, simulation and randomization-based methods have an established history in this field(Freckleton &amp; Harvey, 2006), (Harmon <em>et. al.</em> 2010).  These are promising things to do, and we should do them more often, but I might make a few comments on these approaches.</p>

<p>We are not getting a real power test when we simulate data produced from different models whose parameters have been arbitrarily assigned, rather than estimated on the same data, lest we overestimate the power.  Of course we need to have a likelihood function to be able to estimate those parameters, which is not always available.</p>

<p>It is also common and very useful to assign some summary statistic whose value is expected to be very different under different models of evolution, and look at it&rsquo;s distribution under simulation.  This is certainly valid and has ties to cutting edge approaches in ABC methods, but will be less statistically powerful than if we can calculate the likelihoods of the models directly and compare those, as we do here.</p>

<p>Boettiger, C., Coop, G., &amp; Ralph, P. (2012). IS YOUR PHYLOGENY INFORMATIVE? MEASURING THE POWER OF COMPARATIVE METHODS Evolution DOI: <a href="http://dx.doi.org/10.1111/j.1558-5646.2012.01574.x">10.1111/j.1558-5646.2012.01574.x</a></p>

<h2 id="references">References</h2>

<ul>
<li><p>Boettiger C, Coop G and Ralph P (2012).
&ldquo;is Your Phylogeny Informative? Measuring The Power of Comparative Methods.&rdquo;
<em>Evolution</em>.
<a href="http://dx.doi.org/10.1111/j.1558-5646.2012.01574.x">http://dx.doi.org/10.1111/j.1558-5646.2012.01574.x</a>.</p></li>

<li><p>Pagel M (1999).
&ldquo;Unknown.&rdquo;
<em>Nature</em>, <b>401</b>.
ISSN 00280836, <a href="http://dx.doi.org/10.1038/44766">http://dx.doi.org/10.1038/44766</a>.</p></li>

<li><p>Losos J (2011).
&ldquo;Seeing The Forest For The Trees: The Limitations of Phylogenies in Comparative Biology.&rdquo;
<em>The American Naturalist</em>, <b>177</b>.
ISSN 00030147, <a href="http://dx.doi.org/10.1086/660020">http://dx.doi.org/10.1086/660020</a>.</p></li>

<li><p>Freckleton R and Harvey P (2006).
&ldquo;Detecting Non-Brownian Trait Evolution in Adaptive Radiations.&rdquo;
<em>Plos Biology</em>, <b>4</b>.
ISSN 1544-9173, <a href="http://dx.doi.org/10.1371/journal.pbio.0040373">http://dx.doi.org/10.1371/journal.pbio.0040373</a>.</p></li>

<li><p>Harmon L, Losos J, Jonathan Davies T, Gillespie R, Gittleman J, Bryan Jennings W, Kozak K, McPeek M, Moreno-Roark F, Near T, Purvis A, Ricklefs R, Schluter D, Schulte II J, Seehausen O, Sidlauskas B, Torres-Carvajal O, Weir J and Mooers A (2010).
&ldquo;Early Bursts of Body Size And Shape Evolution Are Rare in Comparative Data.&rdquo;
<em>Evolution</em>.
<a href="http://dx.doi.org/10.1111/j.1558-5646.2010.01025.x">http://dx.doi.org/10.1111/j.1558-5646.2010.01025.x</a>.</p></li>
</ul>

    </article>
  </div>
  <div class="col-md-4">
    <div class="sidebar">
      <aside prefix="og:http://ogp.me/ns/article#">
  
  
  
<div class="article-metadata">

  <p>
  <span class="article-date">
    <i class="fa fa-calendar"></i>
    
    <time datetime="2012-01-19 14:10:49 &#43;0000 UTC" itemprop="datePublished">
      Thu, Jan 19, 2012
    </time>
    
  </span>
  </p>
    

  <p>
  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="../../../categories/evolution">evolution</a
    >
    
  </span>
  
  
  </p>
  
  <p>
  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="../../../tags/my-publications">my-publications</a
    >, 
    
    <a href="../../../tags/r">R</a
    >, 
    
    <a href="../../../tags/research-blogging">research-blogging</a
    >
    
  </span>
  
  
  </p>

</div>

 
  <br />
  
  <p><a class="btn btn-default" rel="prev" href='../../../2012/01/20/friday-lab-group-meeting-notes.html'><i class="fa fa-chevron-left"></i> prev</a>
    <a class="btn btn-default" rel="next" href='../../../2012/01/18/wednesday-meetings.html'>next <i class="fa fa-chevron-right"></i></a></p>

  <br />

  <p> <a class="btn btn-default" 
         href="https://github.com/cboettig/cboettig.github.io/commits/master/content/lab-notebook/2012-01-19-is-your-phylogeny-informative.md"><i class="fa fa-clock-o"></i> history</a></p>

  <p> <i class="fa fa-barcode"></i> SHA: <a href="https://github.com/cboettig/cboettig.github.io/blob/b3630889a5584cd1240e1c9d2208759615c88af4/content/lab-notebook/2012-01-19-is-your-phylogeny-informative.md">b363088</a></p> 


</aside>

    </div>
  </div>
</div>


<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'cboettig';
    var disqus_identifier = '\/2012\/01\/19\/is-your-phylogeny-informative.html';
    var disqus_title = 'Is your phylogeny informative?';
    var disqus_url = '\/2012\/01\/19\/is-your-phylogeny-informative.html';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>

<footer class="site-footer">
  <hr />
  <div class="container">

  <div class="row">
    <div class="col-md-3 col-xs-4 socialicons" style="font-size:20px" typeof="foaf:Person" about="https://carlboettiger.info/#me">
      <p>
      <script type="text/javascript" src="../../../js/obfuscate-email-link.js"></script> 

          <a rel="foaf:account" href="https://twitter.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Twitter'); 
             return false;"><span class="showtooltip" title="follow me on twitter (reading, discussing)"><i class="fa fa-twitter"></i></span></a> 

          <a rel="foaf:account" href="https://github.com/cboettig" 
             onclick="recordOutboundLink(this, 'Outbound Links', 'Github'); 
             return false;"><span class="showtooltip" title="follow me on Github (code, research)"><i class="fa fa-github"></i></span></a>
           <a rel="foaf:weblog" type="application/atom+xml" href="../../../index.xml"  
        class="showtooltip" title="RSS feeds for my blog-style entries." 
         onclick="recordOutboundLink(this, 'Outbound Links', 'RSS'); 
         return false;"><i class="fa fa-rss"></i></a>
       </p>
    </div>

    
    


    <div class="col-md-4 col-md-offset-1 col-xs-4">
	    <p><a onclick="recordOutboundLink(this, 'Outbound Links', 'ONS_claim'); return false;" href="http://onsclaims.wikispaces.com/"><img src="../../../img/ons-aci2-icon.svg" alt="ONS" class="showtooltip" title="An Open Notebook Science (ONS) project claim: Entry provides all content (AC) immediately (I) or without significant delay.  See link for details"/></a></p>
    </div>


    <div class="col-md-3 col-md-offset-1 col-xs-4">
      <p>
      <a rel="license" property="http://creativecommons.org/ns#license" href="http://creativecommons.org/publicdomain/zero/1.0/" onclick="recordOutboundLink(this, 'Outbound Links', 'CC0'); return false;"><img src="../../../img/cc-zero.svg" alt="CC0"/></a> 
      </p>
    </div>
  </div>
</footer>


    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="../../../js/jquery-1.12.3.min.js"></script>
    <script src="../../../js/bootstrap.min.js"></script>
    <script src="../../../js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="../../../js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-18401403-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

 
