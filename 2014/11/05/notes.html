<p>Been thinking about this for a while, but <span class="citation" data-cites="benmarwick">@benmarwick</span> ’s examples with <code>--volumes-from</code> convinced me to give this a try.</p>
<p>While there’s an obvious level of convenience in having something like LaTeX bundled into the <code>hadleyverse</code> container so that users can build nice pdfs, if often feels not very docker-esque to me to just throw the kitchen sink into a container. At the risk of some added complexity, we can provide LaTeX from a dedicated TeX container to a container that doesn’t have it built in, like <code>rocker/rstudio</code>. Check this out:</p>
<p>First, we run the docker container providing the texlive binaries as linked volume. Note that even after the 4 GB <code>texlive</code> container has been downloaded that this is slow to execute due to the volume linking flag (not really sure why that is).</p>
<pre><code>docker run --name tex -v /usr/local/texlive leodido/texlive true</code></pre>
<p>Once the above task is complete, we can run the <code>rstudio</code> container, which doesn’t have tex installed by itself, and access tex by linking:</p>
<pre><code>docker run -dP --volumes-from tex \
 -e PATH=$PATH:/usr/local/texlive/2014/bin/x86_64-linux/ \
 rocker/rstudio</code></pre>
<p>We can now log into RStudio, create a new Rnw file and presto, RStudio discovers the tex compilers and builds us a pdf. This does make our Docker execution lines a bit long, but that’s what <a href="www.fig.sh">fig</a> is for. (Or a good ole Makefile).</p>
<p>Note this requires we build <code>texlive</code> in a way that isolates it to it’s own path (e.g. <code>/usr/local/texlive</code>). The default installation with <code>apt-get</code> installs everything in separate locations that overlap with existing directories (like <code>/usr/bin</code>), which makes linking clumsy or impossible (we would need separate paths for all the components, e.g. since shared libraries aren’t found under the <code>bin</code> path, and we cannot link such a volume to another container without destroying everything in it’s <code>/usr/bin</code>, clearly not a good idea). Instead, if we use the standard <code>texlive</code> install script from <a href="https://www.tug.org/texlive/">https://www.tug.org/texlive/</a>, this installs everything into <code>/usr/local/texlive</code> which is much more portable as illustrated above. Not quite sure if it’s actually a good idea to build containers this way or not.</p>
<p>I’ll keep shipping latex inside the <code>hadleyverse</code> container (has about 300 MB of texlive that covers most common usecases), but this is certainly an intruging recipe to mix and match.</p>
